%# -*- coding:utf-8 -*-
\subsection[主动脉分割]{基于测地活动轮廓的主动脉分割}

\begin{frame}
\begin{itemize}
\item \textbf{血管介入仿真中主动脉模型的作用}
\begin{itemize}
\item 可视化环境的组成部分
\item 虚拟导管运动的必经路径
\item 虚拟导管交互的硬约束
\end{itemize}
\pause \item \textbf{血管介入仿真中主动脉模型的获取}
\begin{itemize}
\item 几何形状近似的中空管道
\item 逐帧手动提取主动脉区域
\item 医学影像处理方式
\end{itemize}
\pause \item \textbf{主动脉内腔的分割与可视化}
\begin{itemize}
\item 仍是医学影像领域中一项具有挑战性的工作
\item 主动脉形态特点：走向稳定，截面大小变化均匀
\item 分割时的主要困难：与骨骼以及腹腔内脏器有交叠，影响分割
\end{itemize}
\end{itemize}
\end{frame} 

\begin{frame}
\begin{itemize}
\item \textbf{测地活动轮廓（GAC）~[Caselles(1997)]}
\begin{itemize}
\pause \item 根植于“蛇”模型
\begin{itemize}
\item 基于图像内容呈现的物理性质，通过演进一个轮廓（或“围线”），探测物体边缘
\item 演进通过使一个能量泛函最小化来实现，取得（局部）最小值的位置恰好是目标物体的边缘
\item \textbf{“蛇”的缺点}：轮廓无法控制自身拓扑；无法同时探测多个目标
\end{itemize}
\pause \item 对“蛇”模型的改进
\begin{itemize}
\item 引入测地学计算和水平集演进
\item 允许围线同时探测图像中多个目标的内部边缘和外部边缘
\end{itemize}
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\onslide<1-2> \item \textbf{经典“蛇”模型}
\begin{equation*}
% \label{eqn:aorta_particular_snakes}
E(\mathcal{C}) = \alpha \int_0^1 | \mathcal{C}'(q) |^2 dq + \beta \int_0^1 | \mathcal{C}''(q) |^2 dq - \lambda \int_0^1 | \nabla I_{s} ( \mathcal{C}(q) ) |dq
\end{equation*}
\onslide<2>  \item \textbf{GAC的数学模型}
% \end{itemize}
\begin{equation*}
% \label{eqn:aorta_particular_snakes}
E(\mathcal{C}) = \alpha \int_0^1 | \mathcal{C}'(q) |^2 dq - \lambda \int_0^1 | \nabla I_{s} ( \mathcal{C}(q) ) |dq
\end{equation*}
% \quad\quad其中：
\onslide<1-2> \begin{itemize}
\item $E(\cdot)$：能量泛函
\item $\mathcal{C}(\cdot)$：参数化平面内曲线
\item $I_{s}(\cdot)$：含有待探测目标的图像
\item $\alpha$：传导常数
\item $\beta$：扩散常数
\item $\lambda$：曲率常数
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\onslide<1-3> \item \textbf{围线演进的光学比拟}：光学中的Fermat原理
\begin{equation*}
L_{R} = \int_{A}^{B} n(s) ds
\end{equation*}
\begin{itemize}
\item $L_{R}$：光线在介质中的传播路径的弧长
\item $A$，$B$：传播路径的起点和终点
\item $n(\cdot)$：介值的折射率
\end{itemize}
\onslide<2-3> \item \textbf{Fermat原理的结论：在传播过程中，路径不是直线，而是按最短光程的方式来确定}
\onslide<3> \item \textbf{GAC模型：在界面演进过程中，使能量$E$达到局部最小}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\onslide<1-2> \item \textbf{围线演进目标}
\begin{equation*}
\min \int_0^1 g(|\nabla I_{s} ( \mathcal{C} (q) )|) |\mathcal{C}' (q)| dq
\end{equation*}
\begin{itemize}
\item $g(\cdot)$等同于曲线演进速度，依赖细节几何性质，独立于测地计算
\end{itemize}
\onslide<2> \item \textbf{基于特征图像的演进目标}
\begin{equation*}
\min \int_0^1 g(\nabla I_{\sigma}) |\mathcal{C}' (q)| dq
\end{equation*}
\begin{itemize}
\item $I_{\sigma}$：源图像的特征图像
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\onslide<1-2> \item \textbf{围线演进方程}：当下式右边为零时，围线演进至目标的边缘处
\begin{equation*}
\label{eqn:EvolutionModel}
\frac{\partial \mathcal{C}(t)}{\partial t} = g(I_{\sigma}) \kappa \mathcal{N} - (\nabla g(I_{\sigma}) \cdot \mathcal{N}) \mathcal{N}
\end{equation*}
\begin{itemize}
\item $\kappa$：曲线$\mathcal{C}$的曲率
\item $\mathcal{N}$：指向曲线$\mathcal{C}$“内部”的单位法向量
\end{itemize}
\onslide<2> \item \textbf{围线更新方程}：围线的演进等同于其嵌入水平集$u$的更新
\begin{equation*}
\frac{\partial u}{\partial t} = g(I_{\sigma}) |\nabla u| \kappa + \nabla g(I_{\sigma}) \cdot \nabla u
\end{equation*}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\item \textbf{主动脉内腔分割流程}
\end{itemize}
\begin{figure}[t]
\centering
\input{../../FigureSrc/gac/data_flow_utf8}
% \includegraphics[width=3.2in]{Figures/gac/DataFlow.eps}
% \caption[主动脉内腔分割流程]{主动脉内腔分割流程。}
% \label{fig:aorta_data_flow}
\end{figure}
\end{frame}

\begin{frame}
\begin{itemize}
\item \textbf{原始图像的ROI提取}
\begin{itemize}
\pause \item 设定矩形区域的起点和尺寸
\pause \item 缩小处理区域，减轻运算负担
\end{itemize}
\end{itemize}
\begin{figure}[t]
\centering
\includegraphics[width=2.0in]{../../Figures/gac/ROI.eps}
% \caption[原始图像的ROI提取]{原始图像的ROI提取。}
% \label{fig:aorta_roi}
\end{figure}
\end{frame}

\begin{frame}
\begin{itemize}
  \item \textbf{特征图像的生成步骤}：
  \begin{enumerate}
    \onslide<1-3> \item 保护物体边缘的平滑处理（曲率各向异性扩散滤波，$\text{传导参数} = 9.0$）
    \onslide<2-3> \item 梯度幅值计算（基于Gaussian核，$\sigma = 0.9$）
    \onslide<3> \item 像素亮度非线性映射（S型函数，$m = -3$, $n = 20$）
  \end{enumerate}
\end{itemize}
\begin{columns}[b,onlytextwidth]
\begin{column}{.3\textwidth}
\onslide<1-3> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/gac/dcm_smoothing.eps}
\end{figure}
\end{column}
\begin{column}{.3\textwidth}
\onslide<2-3> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/gac/dcm_gradient.eps}
\end{figure}
\end{column}
\begin{column}{.3\textwidth}
\onslide<3> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/gac/dcm_sigmoid.eps}
\end{figure}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
\begin{itemize}
  \item \textbf{水平集演进过程}：
  \begin{enumerate}
    \onslide<1-4> \item 阈值滤波（$\text{TH}_{\text{lower}} = 300\text{HU}$, $\text{TH}_{\text{upper}} = 2000\text{HU}$）
    \onslide<2-4> \item 从某一种子点开始，利用快速步进法进行的初始水平集演进
    \onslide<3-4> \item 利用测地活动轮廓进行边缘检测（迭代次数: $100$）
    \onslide<4>  \item 利用二值阈值滤波完成像素亮度的反转（明亮区域的亮度值: $255$, 黑暗区域的亮度值: $0$）
  \end{enumerate}
\end{itemize}
\begin{columns}[b,onlytextwidth]
\begin{column}{.25\textwidth}
\onslide<1-4> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/gac/dcm_threshold.eps}
\end{figure}
\end{column}
\begin{column}{.25\textwidth}
\onslide<2-4> \begin{figure}[t]
\centering
\setlength{\fboxrule}{0.1pt}
\setlength{\fboxsep}{0cm}
\fbox{\includegraphics[height=1.5in]{../../Figures/gac/dcm_fastMarching.eps}}
\end{figure}
\end{column}
\begin{column}{.25\textwidth}
\onslide<3-4> \begin{figure}[t]
\centering
\setlength{\fboxrule}{0.1pt}
\setlength{\fboxsep}{0cm}
\fbox{\includegraphics[height=1.5in]{../../Figures/gac/dcm_geodesic.eps}}
\end{figure}
\end{column}
\begin{column}{.25\textwidth}
\onslide<4> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/gac/dcm_out.eps}
\end{figure}
\end{column}
\end{columns}
\end{frame} 

\begin{frame}
\begin{itemize}
  \item \textbf{主动脉内腔分割结果评估（11组体数据）}：
  % \begin{enumerate}
    % \item 基于Jaccard系数
    % \item 基于Dice系数
  % \end{enumerate}
\end{itemize}
\begin{table}[t]
\renewcommand{\arraystretch}{0.5}
% \caption[主动脉内腔分割结果评估]{主动脉内腔表面模型分割结果评估}
% \label{tbl:aorta_evaluation}
\centering
\begin{tabular*}{70mm}{c c c}
\toprule
\hspace{2mm} \small{数据集序号}  & \hspace{2mm} \small{Jaccard}    & \hspace{2mm} \small{Dice}       \\
\midrule
\hspace{2mm} \small{1}           & \hspace{2mm} \small{$0.936434$} & \hspace{2mm} \small{$0.967174$} \\
\midrule
\hspace{2mm} \small{2}           & \hspace{2mm} \small{$0.928468$} & \hspace{2mm} \small{$0.962907$} \\
\midrule
\hspace{2mm} \small{3}           & \hspace{2mm} \small{$0.911307$} & \hspace{2mm} \small{$0.953595$} \\
\midrule
\hspace{2mm} \small{4}           & \hspace{2mm} \small{$0.918612$} & \hspace{2mm} \small{$0.957580$} \\
\midrule
\hspace{2mm} \small{5}           & \hspace{2mm} \small{$0.893099$} & \hspace{2mm} \small{$0.943531$} \\
\midrule
\hspace{2mm} \small{6}           & \hspace{2mm} \small{$0.953753$} & \hspace{2mm} \small{$0.976329$} \\
\midrule
\hspace{2mm} \small{7}           & \hspace{2mm} \small{$0.983812$} & \hspace{2mm} \small{$0.991840$} \\
\midrule
\hspace{2mm} \small{8}           & \hspace{2mm} \small{$0.922035$} & \hspace{2mm} \small{$0.959436$} \\
\midrule
\hspace{2mm} \small{9}           & \hspace{2mm} \small{$0.928791$} & \hspace{2mm} \small{$0.963081$} \\
\midrule
\hspace{2mm} \small{10}          & \hspace{2mm} \small{$0.937794$} & \hspace{2mm} \small{$0.967899$} \\
\midrule
\hspace{2mm} \small{11}          & \hspace{2mm} \small{$0.950207$} & \hspace{2mm} \small{$0.974468$} \\
\bottomrule
\end{tabular*}
\end{table}
\end{frame} 

% \begin{frame}
% \begin{itemize}
  % \item \textbf{主动脉内腔分割结果评估}：
  % \begin{enumerate}
    % \pause \item Jaccard系数
    % \pause \item Dice系数
  % \end{enumerate}
% \begin{figure}[t]
% \centering
% \input{../../FigureSrc/gac/index_utf8}
% \end{figure}
% \end{itemize}
% \end{frame}

\begin{frame}
\begin{itemize}
  \item \textbf{主动脉内腔分割结果评估}：
  \begin{enumerate}
    \onslide<1-4> \item 基于Jaccard系数（均值为$0.933$，标准差为$0.0240$）
	\begin{itemize}
	\onslide<2-4> \item 交集占并集的比重
	\end{itemize}
    \onslide<3-4> \item 基于Dice系数（均值为$0.965$，标准差为$0.0128$）
	\begin{itemize}
	\onslide<4> \item 交集占和平均的比重
	\end{itemize}
  \end{enumerate}
\end{itemize}
\begin{columns}[b,onlytextwidth]
\begin{column}{.5\textwidth}
\onslide<1-4> \begin{figure}[t]
\centering
\includegraphics[width=1.8in,height=1.3in]{../../Figures/gac/Jaccard.eps}
\end{figure}
\end{column}
\begin{column}{.5\textwidth}
\onslide<3-4> \begin{figure}[t]
\centering
\includegraphics[width=1.8in,height=1.3in]{../../Figures/gac/Dice.eps}
\end{figure}
\end{column}
\end{columns}
\end{frame} 

\begin{frame}
\begin{itemize}
  \item \textbf{主动脉内腔三维模型}：
\end{itemize}
\begin{figure}[t]
\centering
\includegraphics[height=1.8in]{../../Figures/gac/model.eps}
% \caption[主动脉内腔三维模型]{主动脉内腔三维模型。}
% \label{fig:aorta_visualization}
\end{figure} 
\end{frame} 
