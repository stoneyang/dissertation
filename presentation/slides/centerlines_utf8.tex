%# -*- coding:utf-8 -*-
\subsection[中心线提取]{基于Voronoi图的血管模型中心线提取}

\begin{frame}
\begin{itemize}
\item \textbf{血管介入仿真中血管模型中心线的作用}
\begin{itemize}
\pause \item 提供虚拟解剖环境中的血管的几何信息
\begin{itemize}
\item 走向，半径，分岔位置
\end{itemize}
\pause \item 为虚拟导管行进状态的探测提供基准
\begin{itemize}
\item 状态探测：沿中心线均匀分布的空心球（半径小于血管内径）
\end{itemize}
\end{itemize}
\pause \item \textbf{血管介入仿真中血管模型中心线的提取}
\begin{itemize}
\pause \item 顶点连接性检验
\pause \item 无损的表面平整和修补
\pause \item 表面细分
\pause \item 中心线提取
\end{itemize}
% \item \textbf{心脏近似区域的分割与可视化}
% \begin{itemize}
% \item 是医学影像领域中的一项极具挑战性的工作
% \item 形态特征：不规则的空间管状物，走向和半径变化复杂
% \item 分割时的主要困难：亮度过低不易观察，细节丢失严重
% \begin{itemize}
% \item 只分割心脏的近似区域，得到近似模型，满足仿真需要
% \end{itemize}
% \end{itemize}
\end{itemize}
\end{frame}

% \begin{frame}
% \begin{itemize}
% \item Butterfly scheme vs. Improved butterfly scheme
% \begin{itemize}
% \item Butterfly scheme
% \begin{itemize}
% \item can produce refined surface over regular triangular surface (all vertices have valence 6)
% \item can produce undesirable artifacts at vertices with valence other than 6
% \end{itemize}
% \end{itemize}
% \begin{itemize}
% \item Improved butterfly scheme
% \begin{itemize}
% \item can produce refined surface over both regular and irregular (not all vertices have valence 6) triangular surface
% \end{itemize}
% \end{itemize}
% \end{itemize}
% \end{frame}

\begin{frame}
\begin{itemize}
\item \textbf{中心线（中心轴）} ： 
\begin{itemize}
\item 物体的最大内切圆（2D）或最大内切球（3D）形心的轨迹~[Amenta(2001)]
\item 为仿真中的过程建模提供有效形状描述
\end{itemize}
\onslide<1-5> \item 中心线提取的四类方法：
\begin{itemize}
\onslide<2-5> \item 拓扑薄化
\onslide<3-5> \item 距离变换
\onslide<4-5> \item 草原之火（"prairie fire"）
\onslide<5> \item \alert{Voronoi图（VD）}
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\item \textbf{Voronoi图}：
\begin{itemize}
\item 平面或三维形体中心线的离散化估计
\end{itemize}
\item \textbf{中心线}
\begin{itemize}
\item 模型表面内部VD的最短作用路径~[Antiga(2003)]
\begin{itemize}
% \item \alert{中心点}：到表面边界最短距离局部最大
\item \alert{作用路径}：连接VD上两个顶点的连线
\end{itemize}
\item 中心点通过求取作用路径线积分的最小值获得
\begin{itemize}
\item \alert{中心点}：到表面边界最短距离局部最大
% \item \alert{作用路径}：连接VD上两个顶点的连线
\end{itemize}
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\item 从VD上某给定起始点开始计算Eikonal方程
\begin{equation*}
\left| \nabla T \right| = \frac{1}{R(u)}
\end{equation*}
\begin{itemize}
\item $T$：到达时刻
\item $R$：$T$时刻最大内切球的半径
\item $u$：VD的参数空间
\end{itemize}
\item 中心线则利用最速下降法求得
\begin{equation*}
\frac{d}{ds} c = - \nabla T
\end{equation*}
\begin{itemize}
\item $c$：中心线
\item $s$：$c$的参数空间
\end{itemize}
\end{itemize}
\end{frame}

% \begin{frame}
% \begin{itemize}
  % \item \textbf{表面模型中心线提取流程}：
% \end{itemize}
% \begin{figure}[t]
% \centering
% \input{../../FigureSrc/postprocessing/centerlines/data_flow_utf8}
% \end{figure}
% \end{frame}

\begin{frame}
\begin{itemize}
  \item \textbf{区段模型及其顶点连接性验证}：
  \begin{itemize}
    \onslide<1-2> \item 主动脉下半段表面模型（由$205,590$个多边形构成）与VOI提取的模型局部（红色方框内）
    \onslide<2> \item 所提取区段血管表面模型的连接性验证结果（多边形面片数量：$70,625$）
  \end{itemize}
\end{itemize}
\begin{columns}[b,onlytextwidth]
\begin{column}{.5\textwidth}
\onslide<1-2> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/postprocessing/centerlines/VOI.eps}
\end{figure}
\end{column}
\begin{column}{.5\textwidth}
\onslide<2> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/postprocessing/centerlines/connectivity_local.eps}
\end{figure}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
\begin{itemize}
  \item \textbf{连接性检验前后的多边形数量}：
  \begin{enumerate}[(a)]
    \onslide<1-3> \item 本章实验模型
    \onslide<3> \item 主动脉下半段
  \end{enumerate}
\end{itemize}
\begin{table}
\renewcommand{\arraystretch}{0.5}
\centering
\begin{columns}[b,onlytextwidth]
\begin{column}{.5\textwidth}
\onslide<2-3> 
\centering
\begin{tabular*}{35mm}{lc}
\toprule
~                                & \small{多边形数量} \\
\midrule
\small{验证前}                   & \small{$70,625$}  \\
\midrule
\small{验证后}                   & \small{$70,625$}  \\
\bottomrule
\end{tabular*}
\end{column}
\begin{column}{.5\textwidth}
\onslide<3>
\centering
\begin{tabular*}{35mm}{lc}
\toprule
~                                & \small{多边形数量} \\
\midrule
\small{验证前}                   & \small{$205,590$}  \\
\midrule
\small{验证后}                   & \small{$205,452$}  \\
\bottomrule
\end{tabular*}
\end{column}
\end{columns}
\end{table}
\end{frame}

\begin{frame}
\begin{itemize}
  \item \textbf{设置不同参数获得的平滑结果}：（$N$：迭代次数；$\delta$：带宽）
  \begin{itemize}
  \item \textbf{目的}：中心线提取运算对噪声较敏感
  \end{itemize}
\end{itemize}
\begin{figure}[t]
% \begin{table}[t]
\renewcommand{\arraystretch}{0.5}
% \caption[为平滑算法设置不同的参数所获得的结果]{为平滑算法设置不同的参数所获得的结果（$N$：迭代次数；$\delta$：带宽）}
% \label{tbl:mesh_smooth}
\centering
\begin{tabular}{|c|c|c|}
\hline
\bigstrut ~                                   & \raisebox{-1mm}{$N = 30$}                                                                     & \raisebox{-1mm}{$N = 100$}                                                  \\
\hline
\bigstrut[t] \raisebox{0mm}{$\delta = 0.1$}  & \Includegraphics[height=1.0in]{../../Figures/postprocessing/centerlines/smooth_30_1_local.eps}  & \Includegraphics[height=1.0in]{../../Figures/postprocessing/centerlines/smooth_30_01_local.eps}  \\
\hline
\bigstrut[b] \raisebox{0mm}{$\delta = 0.01$} & \Includegraphics[height=1.0in]{../../Figures/postprocessing/centerlines/smooth_100_1_local.eps} & \Includegraphics[height=1.0in]{../../Figures/postprocessing/centerlines/smooth_100_01_local.eps} \\
\hline
\end{tabular}
% \caption[设置不同参数获得的平滑结果（中心线）]{设置不同参数获得的平滑结果。（$N$：迭代次数；$\delta$：带宽）}
% \label{fig:centerlines_smooth}
% \end{table}
\end{figure}
\end{frame}

\begin{frame}
\begin{itemize}
  \item \textbf{表面细分}：生成光滑且视觉满意的表面~[Zorin(1996)]
  \begin{itemize}
    \item 进一步平抑噪声，提高中心线计算准确性
    \item 使表面的表达更加精确，确保中心线计算的稳定性
    % \item 左：表面细分的局部
    % \item 右上：表面细分之前的多边形表面
    % \item 右下：表面细分之后的多边形表面
  \end{itemize}
\end{itemize}
\begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/postprocessing/centerlines/subdivision.eps}
% \caption[对平整后表面进行细分]{对平整后表面进行细分。左：表面细分的局部。右上：表面细分之前的多边形表面。右下：表面细分之后的多边形表面。}%
% \label{fig:centerlins_subdivision_local}
\end{figure}
\end{frame} 

\begin{frame}
\begin{itemize}
  \item \textbf{表面细分前后多边形数量对比}：
  \begin{enumerate}[(a)]
    \onslide<1-3> \item 本章实验模型
    \onslide<3> \item 主动脉下半段
  \end{enumerate}
\end{itemize}
\begin{table}[t]
\renewcommand{\arraystretch}{0.5}
% \caption[表面细分前后多边形数量对比]{表面细分前后多边形数量对比。(a) 本章实验数据；(b) 完整的血管模型。}
% \label{tbl:centerlins_subdivision}
\centering
\begin{columns}[b,onlytextwidth]
\begin{column}{.5\textwidth}
\onslide<2-3> 
\centering
\begin{tabular*}{35mm}{lr}
\toprule
~              & \small{多边形数量} \\
\midrule
\small{细分前} & \small{$70,625$}     \\
\midrule
\small{细分后} & \small{$281,060$}    \\
\bottomrule
\end{tabular*}
\end{column}
\begin{column}{.5\textwidth}
\onslide<3> 
\centering
\begin{tabular*}{35mm}{lr}
\toprule
~              & \small{多边形数量} \\
\midrule
\small{细分前} & \small{$205,452$}    \\
\midrule
\small{细分后} & \small{$821,808$}    \\
\bottomrule
\end{tabular*}
\end{column}
\end{columns}
\end{table}
\end{frame} 

\begin{frame}
\begin{itemize}
  \item \textbf{不同区段模型的中心线提取结果}
\end{itemize}
\begin{figure}[t]
% \begin{table}[t]
\renewcommand{\arraystretch}{0.5}
% \caption[为平滑算法设置不同的参数所获得的结果]{为平滑算法设置不同的参数所获得的结果（$N$：迭代次数；$\delta$：带宽）}
% \label{tbl:mesh_smooth}
\centering
\begin{tabular}{|c|c|c|}
\hline
\bigstrut ~                                  & \raisebox{-1mm}{Voronoi图}                                                                     & \raisebox{-1mm}{中心线}                                                  \\
\hline
\bigstrut[t] \raisebox{0mm}{本章实验模型}  & \Includegraphics[height=1.0in]{../../Figures/postprocessing/centerlines/overlay_100_01_voronoi_local.eps}  & \Includegraphics[height=1.0in]{../../Figures/postprocessing/centerlines/overlay_100_01_centerlines_local.eps}  \\
\hline
\bigstrut[b] \raisebox{0mm}{主动脉下半段} & \Includegraphics[height=1.0in]{../../Figures/postprocessing/centerlines/overlay_100_01_voronoi.eps} & \Includegraphics[height=1.0in]{../../Figures/postprocessing/centerlines/overlay_100_01_centerlines.eps} \\
\hline
\end{tabular}
% \raisebox{45mm}{\includegraphics[height=1.0in,width=0.2in]{Figures/postprocessing/centerlines/scalarbar.eps}}
% \raisebox{-45mm}{\includegraphics[width=0.2in]{Figures/postprocessing/centerlines/scalarbar2.eps}}
\raisebox{-20mm}{\includegraphics[height=1.5in]{../../Figures/postprocessing/centerlines/scalarbar12.eps}}
% \caption[不同区段模型的中心线提取结果]{不同区段模型的中心线提取结果。}
% \label{fig:centerlines}
% \end{table}
\end{figure}
\end{frame} 

\begin{frame}
\begin{itemize}
  \item \textbf{中心线计算时间}
\end{itemize}
\begin{table}[!ht]
\renewcommand{\arraystretch}{0.5}
% \caption[中心线计算时间]{中心线计算时间}
% \label{tbl:centerlins_computation_time}
\centering
\begin{tabular*}{50mm}{lr}
\toprule
~                                & \small{耗费时间（s）} \\
\midrule
\small{本章实验模型}             & \small{$780$}  \\
\midrule
\small{主动脉下半段}             & \small{$2,760$}  \\
\bottomrule
\end{tabular*}
\end{table}
\end{frame} 

\begin{frame}
\begin{itemize}
  \item \textbf{完整主动脉模型的中心线}：
  \begin{itemize}
    \onslide<1-3> \item 基于CTA的表面模型（多边形的数量：$757,538$）
    \onslide<3> \item 表面模型的中心线
  \end{itemize}
\end{itemize}
\begin{columns}[b,onlytextwidth]
\begin{column}{.5\textwidth}
\onslide<2-3> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/postprocessing/centerlines/surface.eps}
\end{figure}
\end{column}
\begin{column}{.5\textwidth}
\onslide<3> \begin{figure}[t]
\centering
\includegraphics[height=1.5in]{../../Figures/postprocessing/centerlines/centerlines.eps}
\end{figure}
\end{column}
\end{columns}
\end{frame}