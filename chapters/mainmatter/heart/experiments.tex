
\section{实验与结果}
\label{sec:heart_experiments}

\subsection{原始数据与实验设置}
\label{subsec:heart_setup_data}

由于本章的全部工作都针对心脏区域，因此，与第\ref{subsec:coronary_setup_data}类似，我们将包含完整心脏区域的部分从整个原始数据剥离出来（见图\ref{fig:heart_original}）。
\begin{figure}[t]
\centering
\includegraphics[height=2.6in]{Figures/heart/original.eps}
\caption[基于真实病例的心脏区域体数据的前面观]{基于真实病例的心脏区域体数据的前面观。}
\label{fig:heart_original}
\end{figure}

\subsection{预处理}
\label{subsec:heart_preprocessing_experiments}

正如第\ref{subsec:aorta_feature_image}节所述，我们对输入的体数据进行了以下预处理：
\begin{enumerate}
\item 保护目标边缘的图像平滑；
\item 对图像中不感兴趣内容的去除；
\item 图像梯度幅值的计算；
\item 输入围线的生成。
\end{enumerate}
作为预处理的第一步，我们首先对图像进行平滑处理。
依据式(\ref{eqn:aorta_MCDE})，在平滑处理的过程中，图像中各个物体的边缘得以完好保持。

然后，为除去图像中不感兴趣的内容（即：除心脏以外的物体），我们引入第\ref{subsubsec:heart_binary}节介绍的二值阈值滤波器。
在图\ref{fig:heart_binary_threshold_experiments}中，我们可以观察到，所有“有用的”内容都以高亮度来显示（本实验中设置亮度为$255$），而所有“没用的”内容都以低亮度来显示（本实验中设置亮度为$0$）。
\begin{figure}[t]
\centering
\includegraphics[height=2.6in]{Figures/heart/binary_threshold.eps}
\caption[二值阈值处理后的心脏区域体数据的前面观]{二值阈值处理后的心脏区域体数据的前面观。注意其中的心包，以及大部分血管等内容都已被除去。}%
\label{fig:heart_binary_threshold_experiments}
\end{figure}

\subsection{梯度与初始围线的计算}

与第\ref{subsec:aorta_preprocessing}节类似，我们需要为GAC计算特征图像和初始的水平集围线，这两部分计算同时进行。

\subsubsection{计算梯度}

计算特征图像同样需要经过两个环节：首先计算梯度，然后再利用S型函数进行非线性映射。

关于计算图像的梯度，我们仍然应用式(\ref{eqn:aorta_gaussian})进行，Gaussian核的方差仍然设置为$\sigma = 0.9$。

由式(\ref{eqn:aorta_sigmoid})定义的S型函数具有四个参数：用于控制窗宽的$m$，控制窗中心位置的$n$，以及确定输出图像中像素亮度极值的$\alpha$（极小值）和$\beta$（极大值）。
% 图\ref{fig:heart_sigmoid_width}显示参数$m$如何控制S型函数的窗宽。
参数$m$的值越大，窗宽越宽；反之，则窗宽越窄。
而负的$m$则意味着由其确定的S型函数对输入图像中的像素强度值具有取反作用。
% 图\ref{fig:heart_sigmoid_center}显示参数$n$如何控制S型函数几何中心相对于坐标原点的横向距离。
参数$n$的绝对值越大，则由其确定的S型函数的几何中心相对于坐标原点的横线距离就越大（即：几何中心离坐标原点越远）。
正的$n$说明S型函数向左平移；反之，则说明S型函数向右平移。
如第\ref{subsec:aorta_preprocessing}节所述，在对梯度图像进行转换以生成特征图像的时候，参数$m$和$n$的选取是十分重要的。
它们的取值取决于梯度图像中像素亮度的极值。
在本文的实验中，我们的经验是：$m < 0$，$n > 0$，$n > |m|$。
而鉴于我们的应用需要，通常把$\alpha$设定为$0$，而把$\beta$设定为$255$。
% \begin{figure}[t]
% \centering
% \input{FigureSrc/heart/sigmoid_window_width}
% \caption[S函数的参数$m$与窗宽之间的关系]{S函数的参数$m$与窗宽之间的关系：$m = 4$的曲线（洋红色）具有比$m = -2$的曲线（红色）以及$m = 2$的曲线（绿色）更宽的映射区间。参数$m$的负号表明该S型函数引入了取反作用。}%
% \label{fig:heart_sigmoid_width}
% \end{figure}
% \begin{figure}[t]
% \centering
% \input{FigureSrc/heart/sigmoid_center_location}
% \caption[S函数的参数$n$与窗宽之间的关系]{S函数的参数$n$与窗宽之间的关系：当$n < 0$时，曲线右移（如：绿色的曲线）而当$n > 0$时，曲线左移（如：洋红色的曲线）。$n$的绝对值决定S型函数几何中心与原点的横向距离。}%
% \label{fig:heart_sigmoid_center}
% \end{figure}

\subsubsection{初始围线的演进}

与上述特征图像的计算同时进行的是初始围线的演进计算，我们应用快速步进算法完成该环节。
我们需要将起始点的位置定于目标（即：心脏）的内部，这样，围线将“向外”逐渐演进，并记录沿途的到达时间。

\subsection{测地学活动轮廓的水平集演进}
\label{subsec:heart_geodesic_experiments}

与第\ref{subsec:aorta_level_set}节类似，在特征图像和初始水平围线的生成均完成的情况下，应用GAC来分割心脏区域的外围轮廓。
GAC的演进过程起始于我们为快速步进算法选取的起始点，在特征图像的参考作用下，进行围线演进。
由于心脏区域的形状多变，对于面积较大的区域，就需要为GAC设定较长的迭代步数（本章中最长的步数为$500$），从而给围线的演进以充足的时间，使其最终探测到区域的边缘。

最后，对于GAC的演进结果，我们同样引入二值阈值滤波器进行反转，并应用行进立方体方法\cite{Lorensen1987MC}实现等值面的提取。
图\ref{fig:heart_Heart}展示了应用本章方法所获得心脏区域的近似表面模型。
\begin{figure}[t]
\centering
\includegraphics[height=2.4in]{figures/heart/heart.eps}
\caption[心脏轮廓表面模型的前面观]{心脏轮廓表面模型的前面观。}
\label{fig:heart_Heart}
\end{figure}
