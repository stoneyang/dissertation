
\section{实验与结果}
\label{sec:aorta_experiments}

\subsection{实验场景与数据}
\label{subsec:aorta_setup_data}

为了验证本章所提出的方法对于从CTA中分割主动脉内腔的有效性，并在此基础上获得尽可能满意的结果，我们利用不同的参数进行了实验。
首先，以DICOM格式存储的原始CTA序列要转换成XML格式。
然后，被转换后的数据被同时传输至生成特征图像和输入水平集的两个分支当中。
随后，这两个分支的计算结果作为测地学活动轮廓的的输入。
最后，利用行进立方体方法来实现分割结果的提取。
所有实验运行于一台配有Intel 2.83GHz Core 2 Quad CPU以及4GB内存的台式计算机上。

原始数据利用Siemens的SOMATOM Definition Flash CT来获取，该设备属于128排CT，图像帧间距为$0.6\text{mm}$。
该数据序列中含有病人的完整主动脉信息。
为了叙述方便，本章选取了其中的一帧来说明实验的主要过程。
在实验中，为了缩短计算时间，我们从原始序列中特意截取了含有主动脉及其主要分支的区域（见图\ref{fig:aorta_roi}）。
\begin{figure}[t]
\centering
\includegraphics[width=2.5in]{figures/aorta/ROI.eps}
\caption[ROI提取]{对一张原始图像进行典型的ROI提取。}
\label{fig:aorta_roi}
\end{figure}

\subsection{特征图像的计算}
\label{subsec:aorta_feature_image}

在计算特征图像的分支中，我们需要逐个完成下面的三个任务：
\begin{enumerate}
\item 在不对边缘造成影响的前提下去除图像中的噪声；
\item 计算各像素的梯度的幅值；
\item 将梯度幅值图像映射为满足需要的特征图像。
\end{enumerate}
首先，我们利用具有可变通透度的水平集曲率方法进行图像的平滑降噪处理。
该方法作为一种保护边缘的平滑方法，能够在有效除去图像中的噪声的同时，很好地保护目标物体的边缘特征。
从图\ref{fig:aorta_smoothing}中可以看到，图像中的噪声得到了有效的抑制，而主动脉甚至是一些相对细小的血管（意味着较为薄弱的边缘）都得到了保持。
然后，我们引入梯度幅值模块来进行图像中各像素的梯度幅值计算。
该计算通过对式(\ref{eqn:aorta_gaussian})中所定义的Gaussian核的一阶偏导数进行卷积运算来实现。
从图\ref{fig:aorta_gradient}中可以看到，血管，骨骼，以及皮肤的边缘处的梯度幅值较高（意味着较大的亮度变化）。
完成梯度幅值的计算之后，我们采用了一个非线性的映射关系来生成所需的特征图像。
式(\ref{eqn:aorta_sigmoid})是一个S型函数，在这里，参数的选择极大地依赖于梯度幅值图像中像素亮度的极值。
在本文中，为了实现目标物体（梯度幅值图像中亮度较低区域）与其边缘（梯度幅值图像中亮度较高区域）的反转，$m$必须设定为一个负数，$n$必须设定为一个正数，且$n > |m|$。
通过这个映射获得的特征图像如图\ref{fig:aorta_sigmoid}所示，其中的目标物体的边缘均为低亮度，而其所包围的区域则为高亮度。
这使得随后进行的由式(\ref{eqn:aorta_geodesic_3})所驱动的水平集演进在“平坦区域”（具有均一的高亮度）内速度较快，而在“峡谷”（具有急剧减低的亮度）附近速度极慢（接近于零）。
\begin{figure*}[t]
\centering
\subfloat[]{\includegraphics[width=1.2in]{figures/aorta/dcm_smoothing.eps}%
\label{fig:aorta_smoothing}}
\hfil
\subfloat[]{\includegraphics[width=1.2in]{figures/aorta/dcm_gradient.eps}%
\label{fig:aorta_gradient}}
\hfil
\subfloat[]{\includegraphics[width=1.2in]{figures/aorta/dcm_sigmoid.eps}%
\label{fig:aorta_sigmoid}}
\caption[特征图像的生成步骤]{生成特征图像的三个步骤：(a)保护物体边缘的平滑处理（$\text{conductance parameter} = 9.0$）；(b)基于高斯核的梯度幅值的计算（$\sigma = 0.9$）；(c)利用S型函数进行非线性映射（$m = -3$, $n = 20$）。}
\label{fig:aorta_potential_image_generation}
\end{figure*}
\begin{figure*}[t]
\centering
\subfloat[]{\includegraphics[width=1.2in]{figures/aorta/dcm_threshold.eps}%
\label{fig:aorta_threholding}}
\hfil
\subfloat[]{\includegraphics[width=1.2in]{figures/aorta/dcm_fastMarching.eps}%
\label{fig:aorta_Fast_Marching}}
\hfil
\subfloat[]{\includegraphics[width=1.2in]{figures/aorta/dcm_geodesic.eps}%
\label{fig:aorta_geodesic_active_contours}}
\hfil
\subfloat[]{\includegraphics[width=1.2in]{figures/aorta/dcm_out.eps}%
\label{fig:aorta_binary_thresholding}}
\caption[水平集演进]{水平集的演进：(a)阈值滤波（$\text{lower threshold} = 300\text{HU}$, $\text{higher threshold} = 2000\text{HU}$）；(b)从某一种子点开始、利用快速步进法进行的初始水平集演进；(c)利用测地学活动轮廓进行边缘检测；(d)利用二值阈值滤波完成像素亮度的反转（intensity of the light area: $255$, intensity of the dark area: $0$）。}%
\label{fig:aorta_level_set_evolution}
\end{figure*}

\subsection{水平集演进}
\label{subsec:aorta_level_set}

生成初始水平集的计算与上述计算同时进行，其目的是为测地学活动轮廓的演进提供每一步的形状提示。
在这一过程当中，我们首先引入了阈值计算来滤去输入图像（原始图像）当中的与本步骤无关的内容细节，例如：肝脏，双肾，肠道，胃，等等（见图\ref{fig:aorta_threholding}）。
这个处理能够进一步降低计算任务对内存的占用，同时能够明显地缩短计算时间。
随后，我们引入了快速行进法来生成初始的传播界面。
我们制定了位于主动脉内部的一点作为种子点。
计算过程中，在图像中的某一点，将计算式(\ref{eqn:aorta_curves})中界面到达该点的时刻$T(x,y)$（见图\ref{fig:aorta_Fast_Marching}）。
注意到主动脉所具有的细长的几何特征，以及算法的特性，我们在对完整序列的实验中，沿着主动脉的中心线附近提供了一系列的种子点，这进一步缩短了计算时间，同时获得了更好的计算结果。

测地学活动轮廓的演进以特征图像和输入水平集为初始信息，由式(\ref{eqn:aorta_geodesic_3})所驱动。
由图\ref{fig:aorta_geodesic_active_contours}可以看到，这一演进过程一直进行，直到轮廓到达目标物体的边缘。
随后，我们引入二值阈值滤波，将最终轮廓的“内部”转换为高亮度区域，而轮廓的“外部”则转换为低亮度区域，以便随后的等值面提取（见图\ref{fig:aorta_binary_thresholding}）。
这里，所有通过本实验手动选定的各个参数均可以直接应用于三维（即完整序列）的情形。

\subsection{分割方法的评估}
\label{subsec:aorta_evaluation}

In this paper, the proposed approach is evaluated in terms of two common indices: the Jaccard index \cite{Jaccard1912}, and the Dice index \cite{Zijdenbos1994}.
Suppose that the target image $T$ is evaluated against the source image $S$, $i$ marks the various labels in the source and target images.
Then the Jaccard index $J$ can be represented as the following equation:
\begin{equation}
\label{eqn:aorta_Jaccard}
J = \frac{\sum_i | S_i \bigcap T_i |}{\sum_i | S_i \bigcup T_i |},
\end{equation}
where $S_i$ denotes the $i$-th label in the source image $S$, $T_i$ the $i$-th label in the target image $T$, $| \cdot |$ means the volume computed as the number of voxels (or pixels). The Jaccard index is also called the "union overlap", which means the intersection over the union of the target and source image.

\begin{figure}[t]
\centering
\subfloat[]{\includegraphics[width=3.0in,height=1.98in]{figures/aorta/Jaccard.eps}%
\label{fig:aorta_Jaccard}}\\
\subfloat[]{\includegraphics[width=3.0in,height=1.98in]{figures/aorta/Dice.eps}%
\label{fig:aorta_Dice}}
\caption[分割方法的准确性评估]{分割方法的准确性评估: (a) Jaccard; (b) Dice.}%
\label{fig:aorta_evaluation}
\end{figure}

The Dice index $D$ can be written as:
\begin{equation}
\label{eqn:aorta_Dice}
D = 2 \frac{\sum_i | S_i \bigcap T_i |}{\sum_i ( | S_i | + | T_i |)}.
\end{equation}
It is also called the "mean overlap", which means the intersection divided by the mean volume of the two regions.
Figure \ref{fig:aorta_evaluation} illustrates the two indices of the eleven data sets used in the experiments.

\subsection{基于分割结果的表面重建}

最后，分割所得到的体数据信息将通过行进立方体方法\cite{Lorensen1987MC}进行处理，以获得目标的等值面信息。
等值面的值对应于主动脉内腔边缘的像素亮度值。
这里，之前的二值阈值滤波中的阈值上限被选为等值面的值。
这确保了随后所渲染的表面模型表示主动脉的内腔表面。
最终的可视化模型如图\ref{fig:aorta_visualization}所示。
\begin{figure}[t]
\centering
\includegraphics[width=1.1in]{figures/aorta/model.eps}
\caption[主动脉内腔三维模型]{人体主动脉内腔的三维表面模型。}
\label{fig:aorta_visualization}
\end{figure} 