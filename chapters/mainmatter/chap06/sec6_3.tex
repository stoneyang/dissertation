
\section{实验与结果}
\label{sec6_3}

\subsection{数据与实验设置}

The vasculature surface models were generated by applying the approaches proposed in \cite{Yang2014ICRA} from the original CTA images.
The resolution of the original data was $0.4 \times 0.4 \times 0.6 \text{mm}^3$.
For the sake of simplicity, only a segment of the abdominal aorta is depicted in this paper to demonstrate the effectiveness of our approach (see Fig. \ref{fig:VOI}).
The approach can be ported in order to process the model surfaces of the whole vasculature related to the surgical procedure to be simulated.

All of our experimental programs ran on a desktop machine equipped with Intel's 2.83GHz Core 2 Quad CPU and 4GB RAM.

\begin{figure}[t]
\centering
\includegraphics[height=2.0in]{figures/chap06/original.eps}
\caption[VOI提取的表面模型]{VOI提取的表面模型（由$74307$个多边形构成）。}
\label{fig:VOI}
\end{figure}

\subsection{检验顶点之间的连接性}

First of all, the polygonal elements in the patient-specific surface model of the human vessels need to be checked such that the connectivity between any pair of vertices are validated. %
After doing this, the integration of the model surface is guaranteed that the excessive polygons are kicked off.
Table \ref{tbl:Connectivity} shows that the total number of the polygonal surfaces were not changed, which implies that the given model (i.e., the local one) was already the largest-connected region in the model before the validation process. %

\subsection{表面模型的平滑处理}

Since the unavoidable noises introduced in the phase of image acquisition and processing, uneven surfaces may be found in the surface rendered based on the imagery.
The mess of artifacts and crusts may induce the problems in the smoothness of the delivery of the virtual surgical tools, e.g., guidewires, catheters, etc.
To avoid this situation, a thorough smoothing process is needed on the inner surface of the model, which is equivalent to the smoothing on the model surface per se.
\begin{table}[t]
\renewcommand{\arraystretch}{1.3}
\caption[连接性检验前后的多边形数量]{连接性检验前后的多边形数量}
\label{tbl:Connectivity}
\centering
\begin{tabular}
{@{}l||r@{}}
%{@{}llrr@{}}
%\toprule
\hline
~                       & 多边形数量 \\
\hline\hline
检验前       & $74,307$  \\
检验后       & $74,307$  \\
\hline
\end{tabular}
\end{table}

The algorithm utilized in this processing task is implemented based on the low-pass filtering principles, with two parameters to be tuned in control of the smoothing effect on the objects. %
One of the parameters regulates the number of iterations the algorithm should take.
It is equivalent to the order of the polynomial that approximating the windowed sinc function given in (\ref{eqn:Approximation}).
The other parameter is used to configure the bandwidth of this so-called low-pass filter.

In this work, several parameter sets were given with the aim of searching for the one that can generate the most acceptable results.
The numbers of iterations of the smoothing were chosen to be $30$, $60$, and $100$ in the two cases, where the bandwidths were $0.1$, and $0.01$.

Judging from the resultant models in Fig. \ref{fig:Smooth}, the ones on the top row (see Figures \ref{fig:Smooth30-1}, \ref{fig:Smooth60-1}, and \ref{fig:Smooth100-1}) smoothed with the bandwidth $0.1$ are still fairly rough compared to the input, while the ones on the bottom row (see Figures \ref{fig:Smooth30-01}, \ref{fig:Smooth60-01}, and \ref{fig:Smooth100-01}) with the bandwidth $0.01$ are much better. %
With the increase of the number of iterations, the smoothing effect became more apparent, compared with the column of results from the one on its left.
At this stage of processing, we chose the parameter set which was used to generated the results depicted in Fig. \ref{fig:Smooth100-01} ($\text{no. of iterations} = 100$, $\text{pass band} = 0.01$). %
\begin{figure}[t]
\centering
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_30_1.eps}%
\label{fig:Smooth30-1}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_60_1.eps}%
\label{fig:Smooth60-1}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_100_1.eps}%
\label{fig:Smooth100-1}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_30_01.eps}%
\label{fig:Smooth30-01}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_60_01.eps}%
\label{fig:Smooth60-01}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_100_01.eps}%
\label{fig:Smooth100-01}}
\caption[为平滑算法设置不同的参数所获得的结果]{为平滑算法设置不同的参数所获得的结果：上排展示了$\text{带宽} = 0.1$时的结果，迭代次数分别为：$30$，$60$，$100$；下排展示了$\text{带宽} = 0.01$，迭代次数分别为：$30$，$60$，$100$。}%
\label{fig:Smooth}
\end{figure}

\subsection{精简多边形面片}

The elimination of polygon elements of the model surface was conducted after the smoothing computation terminated demonstrated in the last section.

For the input surface model, over $74$k polygons were required to model the vessel segment by using Marching Cubes method \cite{Lorensen1987MC}.
One can imagine that the overall number of the polygons needed to model the whole aorta and the trees of the coronary arteries.
Rendering the large amount of data will surely exhaust the most memory on any machine with typical hardware configuration, thus no sufficient space could be spared for the interaction and other computation.
To facilitate this situation, we adopted the decimation algorithm introduced in Section \ref{subsec:decimation} with multiple sets of parameters in a series of experiments. %

In this work, the termination conditions of the adopted algorithm were set to $10\%$, $50\%$, $75\%$, $90\%$, and $99\%$, respectively.
By termination condition, which is equivalent to the reduction rate, we mean that the rate of the total number of the polygonal elements deleted with respect to the total number of the polygonal elements in the input model surface. %
This can be written as follows
\begin{equation}
\label{eqn:ReductionRate}
\text{Reduction Rate (\%)} = \frac{\text{No. of \emph{deleted} Polygons}}{\text{No. of Input Polygons}}.
\end{equation}

Table \ref{tbl:Decimate} illustrates the effects of the decimation algorithm.
Figure \ref{fig:Decimate} depicts the visualization results of the decimation with typical parameters.
Observing the results, visualization in Figures \ref{fig:Decimate90} and \ref{fig:Decimate99} contain acceptable amounts of polygons.
However, the visualization in fig. \ref{fig:Decimate99} unveiled obvious alterations in its geometry.
\begin{table}[t]
\renewcommand{\arraystretch}{1.3}
\caption[削减率与削减计算后的表面模型的多边形数量]{削减率与削减计算后的表面模型的多边形数量}
\label{tbl:Decimate}
\centering
\begin{tabular}{c||r r r r r}
\hline
%\bfseries      & \bfseries Quantity of polygonal surfaces \\
削减率 ($\%$)  &    $10$ &    $50$ &    $75$ &   $90$ &  $99$ \\
\hline\hline
多边形数量 & $66875$ & $37153$ & $18576$ & $7430$ & $743$ \\
\hline
\end{tabular}
\end{table}

\subsection{验证削减后的表面模型的交互性能}

我们进行了若干组的测试来验证不同精简率的血管模型与虚拟导丝\cite{Mi2013ROBIO}在仿真环境中的交互性能。
表\ref{tbl:FPS1}列出了本章中所选取的血管模型片段在经过不同精简率处理的结果模型与显示刷新率（frames per second，fps）之间的关系。
表\ref{tbl:FPS2}则列出了完整的血管模型（包含主动脉与冠状动脉）不同精简率处理的结果模型在与fps之间的关系。
从这些结果可以得出，我们采用了精简率为$99\%$的完整血管模型用于后续的交互仿真研究。
\begin{table}[t]
\renewcommand{\arraystretch}{1.3}
\caption[精简率与fps――情形I]{精简率与fps――情形I}
\label{tbl:FPS1}
\centering
\begin{tabular}{c||r r r r r}
\hline
精简率($\%$)    & $10$ & $50$ & $75$ & $90$ & $99$ \\
\hline
仿真初始fps              & $30$ & $35$ & $38$ & $41$ & $42$ \\
\hline
仿真平均fps              &  $6$ & $10$ & $15$ & $18$ & $30$ \\
\hline\hline
是否完成仿真？(是/否)        &  否  &  否  & 是  & 是  & 是  \\
\hline
\end{tabular}
\end{table}
\begin{table}[t]
\renewcommand{\arraystretch}{1.3}
\caption[精简率与fps――情形II]{精简率与fps――情形II}
\label{tbl:FPS2}
\centering
\begin{tabular}{c||r r r r r}
\hline
精简率($\%$)    & $90$ & $95$ & $99$ \\
\hline
仿真初始fps              & $20$ & $32$ & $31$ \\
\hline
仿真平均fps              &  $4$ &  $6$ & $11$ \\
\hline\hline
是否完成仿真？(是/否)        &  否  &  否  & 是  \\
\hline
\end{tabular}
\end{table}

\subsection{讨论}

本章实验中用到的计算机程序都是利用C++实现的。
其中的一些计算方法的实现则采用了VTK\cite{Schroeder2000VTK}中的实现。

在检验表面模型中相邻顶点的连接性的过程中，我们将所采用的算法设置为提取最大连接区域的模式。
为了抑制图像处理过程中所引入的噪声网格的影响，我们采用了一种表面平滑算法通过轻微地改变相关顶点的位置来除去这些网格。
平滑表面的算法具有两个关键的可设置参数，分别用于设置算法的带宽和迭代次数。
通过实验发现，平滑算法的迭代次数与平滑程度呈正相关关系，即：迭代次数越多，表面则越平滑。
另一方面，平滑算法的带宽与平滑程度则呈现出负相关关系，即：带宽越狭窄，表面越光滑。
需要指出的是，平滑算法在平整表面的同时，对表面的几何特征有轻微的破坏。
\begin{figure}[t]
\centering
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_100_01_d10.eps}%
\label{fig:Decimate10}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_100_01_d90.eps}%
\label{fig:Decimate90}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_100_01_d99.eps}%
\label{fig:Decimate99}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_100_01_d10_w.eps}%
\label{fig:Decimate10-w}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_100_01_d90_w.eps}%
\label{fig:Decimate90-w}}
\hfil
\subfloat[]{\includegraphics[height=2.0in]{figures/chap06/smooth_100_01_d99_w.eps}%
\label{fig:Decimate99-w}}
\caption[为削减算法设置不同参数所获得的结果]{为削减算法设置不同参数所获得的结果：上排展示了削减率分别为$10\%$，$90\%$，$99\%$时的结果；下排展示了上排相应削减结果所对应的线框表示。}%
\label{fig:Decimate}
\end{figure}

在削减多边形面片的过程中，我们需要权衡的是：一方面，根据仿真交互系统的需要，我们需要尽可能多地精简模型的数据量；另一方面，过高的精简率会严重扭曲模型的原始几何特征，从而造成对模型的几何特征的严重破坏。
这在选择削减率参数的时候是需要考虑的。
在本章的实验中，我们测试了一系列设置不同精简率的情况，并且成功地确定了生成的结果可接受的精简率参数。
面片削减的输出是progressive网格\cite{Hoppe1996}。
除了前述的对输入网格的削减，结果中的网格很好地保持了模型的几何特征，以及其整体的外观（法线，颜色，等）。

在验证交互性能的过程中，大于10的fps对于本样机是足够的。
在本章中，用于手术仿真研究的主动脉的冠状动脉的表面模型的多边形数量被削减了$99\%$，在交互实验中实现了$11$fps（$> 10$）。