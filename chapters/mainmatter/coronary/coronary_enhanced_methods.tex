
\subsection{多尺度管状物增强}
\label{sec:coronary_enhanced_tubular}

管状物体增强是一种多尺度的线滤波，这种策略可以总结为：突出图像中的“管状”目标，同时抑制其余的图像内容。
为了实现这一策略，本文引入了Sato等人提出的三维多尺度线形滤波算法\cite{Sato1998}。

欲将滤波器的响应整形为某特定宽度的线形并抑制噪声的影响，就需要对像素与Gaussian核的二阶导数进行卷积运算。
这一计算等价与计算三维图像$I(\cdot)$的Hessian矩阵$\mathcal{H}$：
\begin{gather}
\label{eqn:coronary_enhanced_Hessian}
\mathcal{H} = \nabla^2 I =
\begin{bmatrix}
I_{xx} & I_{xy} & I_{xz} \\ I_{yx} & I_{yy} & I_{yz} \\ I_{zx} & I_{zy} & I_{zz}
\end{bmatrix},
\end{gather}
其中，$I_{xx} = \frac{\partial^2 I}{\partial^2 x}$，$I_{xy} = \frac{\partial^2 I}{\partial x \partial y}$，以此类推。
而且，所有这些二阶偏导数都是与Gaussian核$G(x; \sigma)$进行卷积的结果，此处，Gaussian核的标准差为$\sigma$：
\begin{equation}
\label{eqn:coronary_enhanced_gaussian_convolution}
I_{xx} = I \ast \frac{\partial^2 G}{\partial^2 x}
\end{equation}
式(\ref{eqn:coronary_enhanced_Hessian})的特征值为：$\lambda_1$，$\lambda_2$，$\lambda_3$，$\lambda_1 > \lambda_2 > \lambda_3$；
与之相对应的特征向量分别是：$e_1$，$e_2$，$e_3$。

当$\lambda_1 \approx 0$ and $\lambda_2 \approx \lambda_3 \ll 0$时，线测度（line measure）可以表示为：
\begin{equation}
\label{eqn:coronary_enhanced_line_measure}
\lambda_{123} =
\begin{cases}
\left| \lambda_3 \right| \left( \frac{\lambda_2}{\lambda_3} \right)^{\gamma_{23}} \left( 1 + \frac{\lambda_1}{\left| \lambda_2 \right|} \right)^{\gamma_{12}}, & \lambda_1 \le 0 \\
\left| \lambda_3 \right| \left( \frac{\lambda_2}{\lambda_3} \right)^{\gamma_{23}} \left( 1 - \alpha \frac{\lambda_1}{\left| \lambda_2 \right|} \right)^{\gamma_{12}}, & \frac{\left| \lambda_2 \right|}{\alpha} > \lambda_1 > 0 \\
0, & \text{其它}.
\end{cases}
\end{equation}
在式(\ref{eqn:coronary_enhanced_line_measure})中，
额外的参数$\gamma_{12}$，$\gamma_{23}$，以及$\alpha$均为正的常量，
其中，
$\gamma_{12} \in [0, \infty)$用于分辨分支状结构和噪声，以及伪分支，
$\gamma_{23} \in [0, \infty)$控制锐度，
对于任意$\lambda_1$，$\alpha \in (0, 1.0]$保持函数中最后一项对称性。
此外，具有不同的特征值的线形滤波器能够用于增强不同形状的目标物体（见表\ref{tbl:coronary_enhanced_eigenvalues}）。
\begin{table}[h]
\renewcommand{\arraystretch}{0.5}
\caption{增强不同形状所需的特征值}
\label{tbl:coronary_enhanced_eigenvalues}
\centering
\begin{tabular*}{100mm}{cc}
\toprule
\hspace{10mm} \bfseries \small{物体形状}  & \hspace{15mm}                    \bfseries \small{特征值}                       \\
\midrule
\hspace{10mm} \small{明亮的管状}          & \hspace{15mm}  \small{$\lambda_1 \approx 0, \lambda_2 \approx \lambda_3 \ll 0$} \\
\hspace{10mm} \small{暗淡的管状}          & \hspace{15mm}  \small{$\lambda_1 \approx 0, \lambda_2 \approx \lambda_3 \gg 0$} \\
\hspace{10mm} \small{明亮的盘状}          & \hspace{15mm}  \small{$\lambda_1 \approx \lambda_2 \approx 0, \lambda_3 \ll 0$} \\
\hspace{10mm} \small{暗淡的盘状}          & \hspace{15mm}  \small{$\lambda_1 \approx \lambda_2 \approx 0, \lambda_3 \gg 0$} \\
\hspace{10mm} \small{明亮的球状}          & \hspace{15mm}  \small{$\lambda_1 \approx \lambda_2 \approx \lambda_3 \ll 0$}    \\
\hspace{10mm} \small{暗淡的球状}          & \hspace{15mm}  \small{$\lambda_1 \approx \lambda_2 \approx \lambda_3 \gg 0$}    \\
\bottomrule
\end{tabular*}
% \caption{增强不同形状所需的特征值}
\end{table}
