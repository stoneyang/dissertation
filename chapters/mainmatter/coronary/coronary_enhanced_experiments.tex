
\section{基于管状增强CURVES的冠脉分割}
\label{sec:coronary_enhanced_experiments}

\subsection{实验场景与数据}
\label{subsec:coronary_enhanced_setup_data}

\begin{figure}[t]
\centering
\includegraphics[height=2.3in]{Figures/coronary/coronary_enhanced/original.eps}
\caption[心脏区域的VOI提取]{心脏区域的VOI提取。}
\label{fig:coronary_enhanced_original}
\end{figure}
由于本节的全部工作都针对冠状动脉，因此，与第\ref{subsec:heart_setup_data}类似，我们将包含完整心脏区域的部分从整个原始数据剥离出来（见图\ref{fig:coronary_enhanced_original}）。
为了获得较好的分割结果，我们进行了一系列实验，以获得更合适的参数。
首先，在这些实验中，我们仍然对剥离出来的体数据的存储格式和像素的数据类型进行转换，以便于随后进行的计算。
然后，我们对转换后的数据进行增强，该工作采用第\ref{sec:coronary_enhanced_tubular}节中所介绍的算法\cite{Sato1998}进行。
其次，增强后的影像数据将被同时用于生成影像的特征图像和输入水平集。
再次，我们引入CURVES算法在特征图像和输入水平集的基础上来完成冠状动脉的分割。
特征图像的生成过程与第\ref{subsec:coronary_feature_image}节相同，此处不再赘述。
最后，分割结果通过行进立方体方法进行等值面的提取，再由计算机图形系统显示提取结果。
本章中的全部实验均在一部搭载Intel 2.83GHz Core 2 Quad CPU和4GB内存的台式计算机上完成。

图\ref{fig:coronary_enhanced_data_flow}宏观地展示了处理流程。
首先，原始数据中像素的数据类型被转换，以便进行后续的增强计算。
然后，我们利用设定恰当的阈值的阈值滤波器滤去了多数与本章工作无关的图像内容。
随后，我们引入了图像增强环节对图像中的目标管状物体进行增强。
接着，对增强后的图像进行两个并列进行的计算，以生成特征图像和输入水平集。
此后，我们利用改进的测地活动轮廓模型进行演进，从而获得图像中微小而复杂的冠状动脉的边缘信息。
最后，血管的边缘被提取并通过面渲染的方式显示。
\begin{figure}[t]
\centering
\input{FigureSrc/coronary/coronary_enhanced/data_flow}
% \includegraphics[height=3.2in,width=3.2in]{Figures/coronary/coronary_enhanced/DataFlow.eps}
\caption{改进的冠状动脉分割流程。}
\label{fig:coronary_enhanced_data_flow}
\end{figure}

\subsection{管状物增强及后处理}
\label{subsec:coronary_enhanced_tubular_processing}

在管状物体增强之前，我们对输入的数据进行了二值化阈值滤波，以使增强环节的作用能够更集中于细微的明亮管状目标上。
为了达到这一目的，我们利用阈值滤波器除去了输入影像中与本章工作目的无关的细节内容，例如：亮度较低的肺部，亮度较高的骨骼，等等。
如图\ref{fig:coronary_enhanced_binary_1}所示，亮度在阈值上下限之间的像素被重新赋予了一个新的亮度值，本章中，我们将其设定为$255$；而亮度在阈值上下限意外的像素则一律被重新赋予零亮度值。

参照表\ref{tbl:coronary_enhanced_eigenvalues}所列写的形状先验约束，我们为管状增强滤波器设置了探测明亮管状目标（即：冠状动脉）的参数值。
在这些参数中，$\sigma$控制要增强的管状目标物体的横截面的直径，$\gamma_{12}$是管状相似性测度，$\gamma_{23}$则被用于恢复非齐对比度或者亮度损失的血管区域的情形。
正如图\ref{fig:coronary_enhanced_vesselness}，包括冠状动脉和位于肺部区域内的血管在内的具有较小的$\sigma$值的细微血管都获得增强，而具有较大$\sigma$值（即：较大的横截面直径）的管状结构并没有被增强。

增强后的管状目标物体的像素亮度相对较暗，且亮度值的分布较为分散。
这给后续的工作环节中所遇到的像素选择带来不便。
为了解决这种问题，从而使后续的处理易于进行，有必要在实验中引入像素亮度的变换。
在本章中，我们圈定非线性亮度映射（第\ref{subsec:imaging_sigmoid}节）和二值阈值滤波（第\ref{subsec:imaging_binary}节）作为完成这一工作的候选方法。
\begin{figure}[t]
\centering
\subfloat[]{\includegraphics[height=2.1in]{Figures/coronary/coronary_enhanced/binary1.eps}%
\label{fig:coronary_enhanced_binary_1}}
\hfil
\subfloat[]{\includegraphics[height=2.1in]{Figures/coronary/coronary_enhanced/hessian.eps}%
\label{fig:coronary_enhanced_vesselness}}
\caption[基于vesselness的预处理]{基于vesselness的预处理：(a) 二值阈值滤波（$\text{lower threshold} = 300$, $\text{upper threshold} = 600$）；(b) 管状物体增强（$\sigma = 0.9$, $\gamma_{12} = 0.1$, $\gamma_{23} = 2.0$）。}%
\label{fig:coronary_enhanced_preprocessing}
\end{figure}
式(\ref{eqn:imaging_sigmoid})表明非线性亮度映射将输入图像变换为某一亮度范围内的像素获得增强而其余像素的亮度被明显削弱的图像。
只要提供恰当选取的参数，目前已经获得增强的影像中，对应于目标物体的亮度将得以增强，而剩余部分的亮度将被降低。
在另外一组采用二值化阈值滤波器的测试中，正如上文所述，亮度落在特定阈值上下限之间的像素重新赋予新的高亮度，而为亮度落在特定阈值上下限之外的像素统一设置为零（见图\ref{fig:coronary_enhanced_binary_2}）。
对比这两种方法的效果，我们选择二值化滤波器来改善之前管状物体增强所得到的结果（见图\ref{fig:coronary_enhanced_data_flow}）。

\subsection{水平集演进}
\label{subsec:coronary_enhanced_propagation}

\begin{figure}[t]
\centering
\subfloat[]{\includegraphics[height=2.1in]{Figures/coronary/coronary_enhanced/sigmoid.eps}%
\label{fig:coronary_enhanced_sigmoid}}
\hfil
\subfloat[]{\includegraphics[height=2.1in]{Figures/coronary/coronary_enhanced/binary2.eps}%
\label{fig:coronary_enhanced_binary_2}}
\caption[两种像素亮度处理结果对比]{两种像素亮度处理结果对比：(a) 非线性亮度映射（$m = 80$, $n = 120$）；(b) 二值阈值滤波（$\text{TH}_{\text{lower}} = 40$, $\text{TH}_{\text{upper}} = 200$）。}%
\label{fig:coronary_enhanced_intensity_conditioning}
\end{figure}

与第\ref{sec:coronary_experiments}节不同，本章在生成初始的水平集围线的时候应用了一种改进的快速步进算法。
正如第\ref{subsec:imaging_colliding_fronts}节所述，这种算法需要在计算开始时提供成对的起始点。
而当以这两个起始点演进的围线一旦相遇，演进过程即终止。
在选取起始点用于计算的时候，我们需要考虑冠状动脉走向的多变性和空间结构的复杂，一定要在曲率较大（即半径较小）的位置设置起始点，以保证水平集的演进能够将这些区段包含在内。

与第\ref{subsec:coronary_experiments_propagation}节类似，CURVES算法以体数据的特征图像为演进参考，并以上述过程生成的初始水平集围线为输入，根据式(\ref{eqn:coronary_application})进行围线演进。
在手工指定的迭代步数内，围线演进至冠状动脉内壁附近时停止计算，即可得到冠状动脉内壁的表面信息。
图\ref{fig:coronary_enhanced_CURVES}展示CURVES演进的结果。
随后，我们同样需要利用二值阈值滤波来处理这一结果，以便进行等值面的提取等工作。
\begin{figure}[t]
\centering
\includegraphics[height=2.1in]{Figures/coronary/coronary_enhanced/curves.eps}
\caption[增强处理后的CURVES演进]{增强处理后的CURVES演进。}%
\label{fig:coronary_enhanced_CURVES}
\end{figure}

\subsection{分割结果可视化}
\label{subsec:coronary_enhanced_visualization}

与第\ref{subsec:coronary_experiments_isosurface}节所述类似，我们需要显示的表面正是应用本章所述方法所得分割结果的边缘（即冠状动脉的内腔边缘）。
这里，我们同样应用行进立方体方法\cite{Lorensen1987MC}来完成等值面的提取，图\ref{fig:coronary_enhanced_CURVES_visualization}展示了对本章分割结果的表面渲染。
通过对比图\ref{fig:coronary_enhanced_normal_CURVES}，我们可以观察到，不仅冠状动脉主要分支内腔的表面被比较完整地分离出来，而且还进一步提取出了更为细小的分支。
\begin{figure}[t]
\centering
\subfloat[]{\includegraphics[height=2.1in]{Figures/coronary/coronary_enhanced/model_conventional.eps}%
\label{fig:coronary_enhanced_normal_CURVES}}
\hfil
\subfloat[]{\includegraphics[height=2.4in]{Figures/coronary/coronary_enhanced/model_enhanced.eps}%
\label{fig:coronary_enhanced_CURVES_visualization}}
\caption[冠状动脉模型对比]{冠状动脉模型对比：(a) 传统CURVES演进；(b) 管状物增强后的CURVES演进。}%
\label{fig:coronary_enhanced_comparison}
\end{figure}