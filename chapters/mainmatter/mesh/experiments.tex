
\section{实验与结果}
\label{sec:mesh_experiments}

\subsection{数据与实验设置}
\label{subsec:mesh_setup_data}

在本章中，基于原始医学影像数据的血管表面模型通过第\ref{chap:aorta}章的工作获得。
为便于叙述和节省空间，我们在这里只对原先的血管模型的一段应用本章的方法，图\ref{fig:mesh_VOI}说明了本章所用数据的来历。
特别说明的是，本章的方法可以直接用于与介入术仿真相关的完整血管表面模型的优化精简处理。
\begin{figure}[t]
\centering
\includegraphics[height=2.0in]{figures/mesh/original.eps}
\caption[VOI提取的表面模型]{VOI提取的表面模型（由$74,307$个多边形构成）。}
\label{fig:mesh_VOI}
\end{figure}

\subsection{检验顶点之间的连接性}
\label{subsec:mesh_connectivity_experiments}

首先，我们要对基于真实病例的血管表面模型中的多边形元素的顶点的连接性进行检查。
通过这一步骤，使得模型表面的完整性得到保障，并剔除了冗余的多边形元素。
表\ref{tbl:mesh_connectivity}显示，组成模型的多边形的数量在检查前后并未发生变化，这就表明所输入的模型（也就是第\ref{subsec:mesh_setup_data}节所取的一段）在检查之前就已经是完整且无冗余的了。
\begin{table}[t]
\renewcommand{\arraystretch}{0.5}
\caption[连接性检验前后的多边形数量]{连接性检验前后的多边形数量}
\label{tbl:mesh_connectivity}
\centering
\begin{tabular*}{80mm}{lc}
\toprule
~                              & \hspace{15mm} \small{多边形数量} \\
\midrule
\hspace{10mm} \small{检验前}   & \hspace{15mm} \small{$74,307$}  \\
\hspace{10mm} \small{检验后}   & \hspace{15mm} \small{$74,307$}  \\
\bottomrule
\end{tabular*}
\end{table}

\subsection{表面模型的平滑处理}
\label{subsec:mesh_smooth_experiments}

鉴于在图像获取与处理过程中所不可避免的噪声，基于原始医学体数据的血管表面模型上存在大量的不平整片段。
这些衍生物和“尖刺”的问题在于，它们可能会导致将来虚拟工具（主要是虚拟导管，虚拟导丝等）的推送过程不平顺的问题。
为了避免这种情况的出现，我们需要对血管模型的表面进行彻底的平整处理。

正如第\ref{subsec:mesh_smoothing}节所述，本环节采用的算法基于低通滤波器原理，它具有两个可调参数$N$和$\delta$来控制该算法的平整效果。
$N$用于控制算法的迭代次数，它等价于式(\ref{eqn:mesh_approximation})给出的windowed sinc函数的估计多项式的阶数；
而$\delta$则用于设置这个低通滤波器的带宽。

在本章中，我们应用了若干组不同的参数来进行实验，以期获得最好的处理结果。
这里，我们以带宽参数$\delta = 0.1$和$\delta = 0.01$将实验分为两组，在这两组中，我们再分别将迭代次数$N$设置为$30$，$60$，和$100$。

从图\ref{fig:mesh_smooth}中所得到的结果中，我们可以观察得出：
与下面一排（$\delta = 0.01$）相比，上面一排（$\delta = 0.1$）的曲面仍显得较为粗糙。
在同一排的结果中，随着迭代次数的增加，平整的效果也逐渐明显。
处理至这一步，我们选择生成右下角结果的参数（即：$\text{no. of iterations} = 100$，$\text{pass band}$）来作为平整处理的参数。
% \begin{figure}[t]
% \centering
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_30_1.eps}%
% \label{fig:mesh_smooth30-1}}
% \hfil
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_60_1.eps}%
% \label{fig:mesh_smooth60-1}}
% \hfil
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_100_1.eps}%
% \label{fig:mesh_smooth100-1}}
% \hfil\\
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_30_01.eps}%
% \label{fig:mesh_smooth30-01}}
% \hfil
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_60_01.eps}%
% \label{fig:mesh_smooth60-01}}
% \hfil
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_100_01.eps}%
% \label{fig:mesh_smooth100-01}}
% \caption[为平滑算法设置不同的参数所获得的结果]{为平滑算法设置不同的参数所获得的结果：上排展示了$\text{带宽} = 0.1$时的结果，迭代次数分别为：$30$，$60$，$100$；下排展示了$\text{带宽} = 0.01$，迭代次数分别为：$30$，$60$，$100$。}%
% \label{fig:mesh_smooth}
% \end{figure}
\begin{figure}[ht]
% \begin{table}[t]
\renewcommand{\arraystretch}{0.5}
% \caption[为平滑算法设置不同的参数所获得的结果]{为平滑算法设置不同的参数所获得的结果（$N$：迭代次数；$\delta$：带宽）}
% \label{tbl:mesh_smooth}
\centering
\begin{tabular}{|l|c|c|c|}
\hline
\bigstrut ~                                   & \raisebox{-1mm}{$N = 30$}                                     & \raisebox{-1mm}{$N = 60$}                                     & \raisebox{-1mm}{$N = 100$}                                     \\
\hline
\bigstrut[t] \raisebox{30mm}{$\delta = 0.1$}  & \includegraphics[height=180pt]{Figures/mesh/smooth_30_1.eps}  & \includegraphics[height=180pt]{Figures/mesh/smooth_60_1.eps}  & \raisebox{-1mm}{\includegraphics[height=180pt]{Figures/mesh/smooth_100_1.eps}}  \\
\hline
\bigstrut[b] \raisebox{30mm}{$\delta = 0.01$} & \raisebox{-3mm}{\includegraphics[height=180pt]{Figures/mesh/smooth_30_01.eps}} & \raisebox{-3mm}{\includegraphics[height=180pt]{Figures/mesh/smooth_60_01.eps}} & \raisebox{-3mm}{\includegraphics[height=180pt]{Figures/mesh/smooth_100_01.eps}} \\
\hline
\end{tabular}
\caption[为平滑算法设置不同的参数所获得的结果]{为平滑算法设置不同的参数所获得的结果。（$N$：迭代次数；$\delta$：带宽）}
\label{fig:mesh_smooth}
% \end{table}
\end{figure}

\subsection{精简多边形面片}
\label{subsec:decimate_experiments}

我们在完成对模型表面的平整处理后，进行对模型表面的多边形元素的精简。

对于输入的模型表面，共有超过$74$k个多边形用于张成这段血管表面模型。
渲染如此大量的数据会导致主流配置的机器内存的耗尽，这样，就没有足够的空间来满足交互仿真的需要了。
为改善这种情况，我们采用第\ref{subsec:mesh_decimation}节所介绍的多边形精简方法来简化表面模型的数据。
与上一节类似，我们也引入若干组不同的参数进行实验，来筛选尽可能好的配置。

在本章中，精简算法的停止条件即是算法的精简率，即：除去的多边形元素的数量与输入表面的所包含的多边形元素的总数之比：
\begin{equation}
\label{eqn:mesh_reduction_rate}
\text{Reduction Rate （\%）} = \frac{\text{No. of \emph{deleted} Polygons}}{\text{No. of Input Polygons}}.
\end{equation}
在分组实验中，我们分别设精简率为$10\%$，$50\%$，$75\%$，$90\%$，和$99\%$。

表\ref{tbl:mesh_decimate}显示精简算法的效果。
图\ref{fig:mesh_decimate}展示了应用上述参数所得精简后的表面模型。
观察上述结果，我们发现，精简率为$90\%$和$99\%$的结果包含满足可接受数量的多边形。
然而，进一步观察精简率为$99\%$的表面，可以发现该结果对模型原有的几何特性产生了明显的影响。
因此，我们选定精简率$90\%$为本章的工作参数。
\begin{table}[t]
\renewcommand{\arraystretch}{0.5}
\caption[削减率与削减计算后的表面模型的多边形数量]{削减率与削减计算后的表面模型的多边形数量}
\label{tbl:mesh_decimate}
\centering
\begin{tabular*}{100mm}{c r r r r r}
\toprule
%\bfseries      & \bfseries Quantity of polygonal surfaces \\
\hspace{2mm} \small{削减率 （$\%$）}  &     \small{$10$} &     \small{$50$} &     \small{$75$} &    \small{$90$} &  \small{$99$} \\
\midrule
\hspace{2mm} \small{多边形数量}     & \small{$66,875$} & \small{$37,153$} & \small{$18,576$} & \small{$7,430$} & \small{$743$} \\
\bottomrule
\end{tabular*}
\end{table}
\begin{figure}[t]
% \begin{table}[t]
\renewcommand{\arraystretch}{0.5}
% \caption[为削减算法设置不同参数所获得的结果]{为平滑算法设置不同的参数所获得的结果（$N$：迭代次数；$\delta$：带宽）}
% \label{tbl:mesh_decimate}
\centering
\begin{tabular}{|l|c|c|c|}
\hline
\bigstrut ~                                    & \raisebox{-1mm}{$10\%$}                                                                 & \raisebox{-1mm}{$90\%$}                                                               & \raisebox{-1mm}{$99\%$}                                     \\
\hline
\bigstrut[t] \raisebox{30mm}{\small{表面模型}} & \raisebox{-1mm}{\includegraphics[height=178pt]{Figures/mesh/smooth_100_01_d10.eps}}     & \raisebox{-0.8mm}{\includegraphics[height=178pt]{Figures/mesh/smooth_100_01_d90.eps}} & \raisebox{-1mm}{\includegraphics[height=178pt]{Figures/mesh/smooth_100_01_d99.eps}}  \\
\hline
\bigstrut[b] \raisebox{30mm}{\small{线框模型}} & \raisebox{-3mm}{\includegraphics[height=178pt]{Figures/mesh/smooth_100_01_d10_w.eps}}   & \raisebox{-3mm}{\includegraphics[height=178pt]{Figures/mesh/smooth_100_01_d90_w.eps}} & \raisebox{-3mm}{\includegraphics[height=178pt]{Figures/mesh/smooth_100_01_d99_w.eps}} \\
\hline
\end{tabular}
\caption[为削减算法设置不同参数所获得的结果]{为削减算法设置不同参数所获得的结果：上排展示了削减率分别为$10\%$，$90\%$，$99\%$时的结果；下排展示了上排相应削减结果所对应的线框表示。}
\label{fig:mesh_decimate}
% \end{table}
\end{figure}
% \begin{figure}[t]
% \centering
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_100_01_d10.eps}%
% \label{fig:mesh_decimate10}}
% \hfil
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_100_01_d90.eps}%
% \label{fig:mesh_decimate90}}
% \hfil
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_100_01_d99.eps}%
% \label{fig:mesh_decimate99}}
% \hfil\\
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_100_01_d10_w.eps}%
% \label{fig:mesh_decimate10-w}}
% \hfil
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_100_01_d90_w.eps}%
% \label{fig:mesh_decimate90-w}}
% \hfil
% \subfloat[]{\includegraphics[height=2.0in]{figures/mesh/smooth_100_01_d99_w.eps}%
% \label{fig:mesh_decimate99-w}}
% \caption[为削减算法设置不同参数所获得的结果]{为削减算法设置不同参数所获得的结果：上排展示了削减率分别为$10\%$，$90\%$，$99\%$时的结果；下排展示了上排相应削减结果所对应的线框表示。}%
% \label{fig:mesh_decimate}
% \end{figure}

\subsection{验证削减后的表面模型的交互性能}
\label{subsec:mesh_validation}

我们进行了若干组的测试来验证不同精简率的血管模型与虚拟导丝\cite{Mi2013ROBIO}在仿真环境中的交互性能。
表\ref{tbl:mesh_FPS1}列出了本章中所选取的血管模型片段在经过不同精简率处理的结果模型与显示刷新率（frames per second，fps）之间的关系。
表\ref{tbl:mesh_FPS2}则列出了完整的血管模型（包含主动脉与冠状动脉）不同精简率处理的结果模型在与fps之间的关系。
上述两个表格中，
“仿真初始fps”是指虚拟导丝刚送入血管模型时的fps值。
“仿真平均fps”是指虚拟导丝在进给至冠状动脉中给定位置的过程中途径五个不同位置时的fps值的平均值。
“是否完成仿真”是指虚拟导丝是否顺利进给之状动脉中的给定位置。
从这些结果可以得出，我们采用了精简率为$99\%$的完整血管模型用于后续的交互仿真研究。
