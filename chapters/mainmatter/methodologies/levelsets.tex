\section{基于水平集的图像分割}
\label{sec:imaging_levelsets}

\subsection{快速行进算法}

在本文中，我们引入快速行进算法的目的在于生成活动轮廓演进所需的输入水平集。
典型的处理流程是：
先利用阈值滤波（第\ref{subsec:imaging_thresholding}节）将图像中与水平集演进无关的内容细节（如：内脏，骨骼，等）滤去；
再引入快速行进法\cite{Sethian1999}进行初始水平集（或到达时间图）的演进。
这时，由于无关细节已经从图像中除去，因此该方法能够得以高效地进行。
需要指出的是，在快速行进法开始时，我们需要手工输入该运算在图像中的起始位置（即种子点的坐标）。

对于曲线演化问题的求解，主要的方法有三类：质点标注法，水平集方法，以及到达时间法等\cite{Wang2008}。
考虑到本文处理目标的几何特征，曲线演进过程具有单向性，因此，我们选择了到达时间法。
作为到达时间法的一种数值实现，快速行进法一方面借助堆排序来组织输入图像中试探像素集合，另一方面由于每次都从该试探像素集合中寻找具有最小值$T_{min}$的$(i_{min},j_{min})$点，故只需对该点邻接点的$T$值进行更新，无需多次迭代。
从而使其计算到达时间的复杂度由利用传统的Hamilton-Jacobi方程的数值解法求解时的$\mathcal{O}(N^3)$下降到$\mathcal{O}(N^2 \log N)$。

在曲线演化问题中，我们考虑如下关于时间参数$t$演化的曲线：
\begin{equation}
\label{eqn:imaging_curves}
\mathcal{C}(t) = \{(x,y) : T(x,y) = t\},
\end{equation}
其中，$(x,y)$表示图像中某点的二维坐标，
$T(x,y)$表示该曲线到达该点的时刻。
对式(\ref{eqn:imaging_curves})求全导数：
\begin{equation}
\label{eqn:imaging_derivative}
1 = \frac{dT}{dt}
\end{equation}
上式等号右侧可写为：
\begin{equation}
\label{eqn:imaging_derivative2}
\frac{dT}{dt} = \frac{\partial T}{\partial x} \frac{dx}{dt} + \frac{\partial T}{\partial y} \frac{dy}{dt} = \nabla T \cdot \mathbf{F} = | \nabla T | F_{N}
\end{equation}
观察式(\ref{eqn:imaging_curves})和式(\ref{eqn:imaging_derivative2})可得如下Eikonal方程（即稳态的Hamilton-Jacobi方程）：
\begin{equation}
1 = | \nabla T | F_{N},
\end{equation}
其中，$F_{N}$表示图像内某点$(x,y)$处，该曲线沿着其法线方向演进的速度。
当$F_{N} < 0$时，$\mathcal{C}$向“内”演进；反之，则向“外”演进。
而快速行进法实际上就是求解该方程的一种改进的数值实现。
计算的结果是一幅到达时间图，图中的各点所对应的函数值是曲线$\mathcal{C}$演进过程中到达该点的时刻。
因此，此结果事实上记录了整个演进过程，这也是初始水平集又称为到达时间图的缘故。

\subsection{波面碰撞算法}
\label{subsec:imaging_colliding_fronts}

波面碰撞（colliding fronts）――一种改进的快速行进法，其目的是在更为快速地为后续的分割工作生成输入水平集\cite{Antiga2008}。
这种方法的实现建立在经典的快速行进法\cite{Sethian1999}的基础上。
与经典方法不同的是，在同一轮计算中，我们可以同时为其提供两个种子点，两个种子点就意味着两个波面同时传播，该传播过程进行至它们相互“碰撞”为止。
这种设计的优点是，对于选取恰当的两个种子点，我们可以较快地获得水平集结果，比经典的快速行进法更进一步节省计算时间。
