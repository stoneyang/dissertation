\section{多边形曲面细分算法}
\label{sec:visualization_subdivision}

为生成平整且在视觉上满意的表面模型，我们采用一种改进的butterfly策略\cite{Zorin1996}用于表面的细分处理。
该策略事实上是一种插值方法，业已被证明是一种对复杂――尤其是非规则――表面的细分处理问题行之有效的方法。
在这一环节中，我们的原则是改善输入表面的可视化效果，而不影响其原始的形状，同时也为了避免中心线提取运算的不稳定现象（见第\ref{subsec:centerlines_subdivision_experiments}节）。
与二维三角化后的新顶点关联的标量值通过利用这里的插值策略来计算相邻顶点的权值之和而生成。
这些顶点位于构成细分蜡纸（stencil）的邻域中，该蜡纸决定了策略的特征。
通过分析这些蜡纸，计算策略可以迅速辨别新顶点与其邻域的拓扑之间的关系。
表面上各顶点的正常位置和异常位置是两个最为重要的情形。
一旦完成初始的细分循环步骤，具有非$6$价的顶点（即共享该顶点的边数非$6$）的最大数目就不会多于一个。
三角化的各边的重点的新标量值通过下述细分策略来计算：
\begin{itemize}
\item \textbf{连接两个正常顶点的边（均为$6$价）} \quad 其权值可由下式确定：
\begin{equation}
\label{eqn:methodologies_subdivision_case1}
a = \frac{1}{2} - w, \quad b = \frac{1}{8} + 2w, \quad c = -\frac{1}{16} - w, \quad d = w,
\end{equation}
其中，$w$可以取任意小的非负值，在该方法中取$w = 0$；
\item \textbf{连接一个正常顶点（$6$价）和一个$K-$顶点的边（$K \neq 6$）} \quad 
对于$K \geq 5$，其权值如下：
\begin{equation}
\label{eqn:methodologies_subdivision_case2_a}
s_j = \left( \frac{1}{4} + \cos \left( \frac{2 \pi j}{K} \right) + \frac{1}{2} \cos \left( \frac{4 \pi j}{K} \right) \right),
\end{equation}
其中，$j = 0, \dots, K - 1$。
当$K = 3$时，我们选定：
\begin{equation}
\label{eqn:methodologies_subdivision_case2_b}
s_0 = \frac{5}{12}, \quad s_{1,2} = - \frac{1}{12}, 
\end{equation}
而当$K = 4$时，我们选定：
\begin{equation}
\label{eqn:methodologies_subdivision_case2_c}
s_0 = \frac{3}{8}, \quad s_{2} = - \frac{1}{8}, \quad s_{1,3} = 0.
\end{equation}
\item \textbf{连接两个异常顶点的边} \quad 此时，两顶点均为非$6$价顶点，其权值的确定方法依据上一种情形中的相应价数的计算公式来确定；
\item \textbf{边缘处的边} \quad 我们利用$1$维$4$点策略来细分这些边：
\begin{equation}
\label{eqn:methodologies_subdivision_case4}
s_{-1} = s_{2} = -\frac{1}{16}, \quad s_{0} = s_{1} = \frac{9}{16}.
\end{equation}
\end{itemize}
在上述情形中，只有第一种情形输入正常情况，而其余均属异常情况。
这里需要特别指出的是，改进的butterfly策略对于输入表面是否平整很敏感，该策略对充分平整的表面才能生成满意的细分结果。
