%# -*- coding:utf-8 -*-
\chapter{绪\;\;\;论}
\label{chap1}

%本章叙述内容：
%\begin{enumerate}
%  \item 问题声明\cite{liu2003survey}
%  \item 问题背景\cite{basdogan2007vr}
%  \item 研究现状\cite{preim20083d}
%  \item 本文工作\cite{lin1998collision}
%\end{enumerate}

\section{问题声明}
\label{sec1-1}

%本节叙述内容：
%\begin{enumerate}
%  \item 研究动机\cite{azuma1997survey}
%  \item 基本描述\cite{meier2005deformable}
%  \item 解决方案
%\end{enumerate}

\subsection{研究动机}
\label{subsec1-1-1}

受人类现代生活压力大、节奏快等因素的影响，心血管疾病的发病率和致死率逐年攀升。心血管
疾病已经对人类健康造成了严重的危害。随着现代医学的发展，介入式心脏导管术成为治疗这类
疾病的有效手段。与传统手术相比，介入式心脏导管术具有创口小、痛苦少、住院时间短、恢复
快等优势。

以冠心病为代表的心血管疾病是人类现代健康生活的大敌。近半个世纪，世界政治经济的整体状
况趋于稳定，在各国政府的政策引导下，人民饱享经济相对长期稳定发展、生活水平稳步提升的
硕果，尤其是城市人口，其物质生活水平持续不断提高，工作和生活方式也随之发生了翻天覆地
的变化。另一方面，受现代都市生活节奏快、压力大等因素的影响，一些血管疾病、尤其是心血
管疾病正在日益危害着越来越多的人的健康。在我国的城市和乡村，罹患冠心病的患者人数正在
逐年攀升\cite{moh2010annual}\cite{moh2008annual}\cite{moh2007annual}\cite{moh2005annual}\cite{moh2004annual}。
在这样的社会现实情况下，大力发展和提高心血管内科学水平的需求摆在了社会公共卫生管理者
和广大从事心血管内科学领域的医学家、医生和医学教育工作者们的面前。使人类远离疾病困扰、
享受健康生活的天然使命促使医学界不断提出新的诊疗方法和药物配方。以微创介入导管术为代
表的手术诊疗方法是目前心血管内科领域普遍采用的、用于治疗冠心病、动脉狭窄、钙化以及动
脉血管瘤等具体病症的有效方法之一，它具有切口小、创伤轻、痛苦少、恢复快等优点，受到医
学界和社会公众的广泛关注。

然而，相较于传统手术，介入式导管术仍具有一定的局限性，一方面是手术的难度。在整个介入
式手术过程中，医生无法直接通过肉眼观察手术器械的精确位置、而只能通过X光成像来判断器
械的当前位置并估计下一步的运动方向，这给医生的手眼协调造成了障碍；手术工具只能在血管
管腔内进行旋转和进退运动；医生从手术工具获得的触感有限，不利于判断手术工具是否与血管
壁发生接触、甚至碰撞。

另一方面是培训的问题。为了得到充分的训练，见习人员的培训时间较长，能否在手术室中观察
真实手术完全取决于有没有相关病症的病人，使这样的机会变得非常珍贵，而目前不断上涨的卫
生医疗支出又加剧了这个问题，使得临床学习时间急剧减少；另外，对医生手术技术的评估缺乏
客观的、标准的方法和流程，整个评估由经验丰富的高级医务人员进行观察和判断被评估者的水
平，这存在着主观性，不利于训练质量水平的控制。

关于介入手术的训练方法，医学界尚未对何种训练方式更为高效取得一致看法。为了克服这些问
题，欧美的许多在相关医学技术领域处于领先地位的研究机构先后建立了专门的训练中心，用于
培训相关人员，其训练模型包括静态模型和动态模型。这些模型提供了真实的手术工具、显示器、
以及塑料制成的人体组织模型。然而，这些模型仍旧缺乏足够的真实性，而且，我们还是无法客
观评估在这些模型上进行训练的见习人员的技术水平。

目前，最为有效的训练方式当属活体动物训练。在活体动物上进行介入式手术训练，受训人员可
以获得尽可能丰富的解剖结构，以及由每个操作所产生的相应生理反应。虽然这些都与人体不尽
相同，这种训练方法毕竟为受训人员提供了真实性。然而，在活体动物上进行医学和生物实验成
本高昂而且存在争议。

基于计算机虚拟现实技术的手术仿真训练技术应运而生，它可以为受训人员提供与手术相关的触
觉、视觉等感官信息，让受训人员可以像在进行真正手术一样完成训练，而无需借助过多的真实
物料、无需依赖所在单位的时间安排。训练的整个过程可由计算机进行记录并评估，为实现训练
评估的客观性和标准化提供了技术支持。

%为了能够给更多的心血管病患提供手术治疗，对相关专业方向的医生、医学院学员以及从
%事相关领域的工程研究的科研人员的训练变得更加重要。传统的手术训练需要在活体动物
%或者死者捐献的遗体上进行，但是，这类训练方式不仅成本高、不具备可重复性，而且对
%实验场所和参加训练的人员的卫生条件要求都比较严格，因此，这种训练并不能很方便地
%开展，这也相应地影响了心血管内科专业的发展。如果我们能够为这些人员提供一种能够
%克服这些"实际"障碍的训练方式，那么开展这类专业训练、培训和演示将会变得方便、灵
%活、经济和安全。这种手术训练方式我们称之为"虚拟手术(Virtual Surgery)"。

所谓"虚拟手术"，就是指进行这种活动的人，在事先设计好的虚拟或半虚拟的"场景"中，利用这
个场景中所呈现出的视觉、听觉甚至触觉的反馈，在体外进行预定的"手术活动"，从而达到熟悉
手术完整流程、理解手术操作细节以及在此基础上反复训练以熟练掌握这种手术的专业水平。在
这个过程中，我们不需要向操控者提供活体动物或者死者遗体、不需要无菌的实验室环境、更不
需要任何辅助设施和材料，并且还能在任何时间进行操作，所有看得见的设备就是一台计算机和
一套触觉接口(Haptic Interface)。整个系统的核心与关键是运行在这台计算机上的软件系统，
它为操控者提供充分的视觉反馈信息。实现"虚拟手术"的设施称为"虚拟手术系统"，该系统是一
个多学科交叉结合的产物，它应用了包括数字图像处理、计算机图形、计算机科学、机械工程、
力学等多个自然科学和工程学科在内的理论知识和工程技术，紧密结合心血管内科学以及人体解
剖学等方面的医学理论知识和临床技术。该系统首先从真实病例的CT影像数据中分割出手术途径
的血管和病灶所在血管，然后基于此数据进行渲染以得到这些血管的可视化模型（下文中，在不
致产生歧义的地方将一律采用"血管模型"来代替的关于虚拟血管模型的所有称谓），接着将基本
拟合真实力学特性的虚拟导丝/导管模型（下文中，在不致产生歧义的地方将一律采用"导丝"来
代替此处的"导丝/导管"）引入该模型，由操控者通过特别设计的触觉接口依据微创介入导管术
的规程进行操作；系统由操控者通过触觉接口操纵导丝模型在血管模型中进退和旋转，在操纵过
程中，操控者应当能够获得类似于真实手术的触觉感受。与本研究方向紧密相关的一个方向是图
像引导手术，它与本课题的最显著的不同之处在于是否具有真正的作用对象：虚拟手术仅仅提供
触觉接口作为操作者的操作对象；而图像引导手术则是在真实的患者身体上进行手术操作。然而，
虚拟手术系统为操作者提供的有效操作动作与真实的手术中的主要动作完全一致，从而保证了手
术训练的有效性。虚拟手术系统的研究和实现的最终目的，就是为心血管内科医生和相应专业的
学员、以及从事这一方向的科研人员提供一种安全、有效、方便、经济的训练方式和演示方式。
医生和学员可以在这种系统的帮助下，学习、熟悉并初步掌握心血管微创介入导管术的操作流程、
技术细节；科研人员可以在操控这种系统的过程中，了解微创介入导管术，并继续完善已有系统、
甚至设计和实现性能更加出色的系统。再者，如果添加部分特性和功能，本系统有可能可以很方
便地扩展为图像引导手术中的图像引导系统。


\subsection{基本描述}
\label{subsec1-1-2}

本课题的研究目标是实现一种用于心血管微创介入术培训的仿真平台（Simulation Platform），
使受训人员能够"沉浸"在足够真实的场景中，按照预先学习的该手术的相关程序进行模拟仿真手
术的实践，通过这一过程达到训练专业心血管微创介入术医生的目的；再者，临床医师也可以在
此平台上进行术前的方案演练和论证。

本系统是一个以实现关键功能的计算机软件系统为核心，再加上用于为操作者提供操作对象的触
觉操作机构组成的一个混合系统。如果条件允许，我们还可以为触觉操作机构提供一个感官上的
作用对象--仿真人体模型，这种模型将依据成年人体的尺寸制作，操作机构则布置在真正手术时
的穿刺部位，如：腹股沟、腕部等，而无需突出其体腔内部的各个器官。

系统中的计算机软件部分需要具备的基本功能可以概略地划分为三部分：基于真实病例的CT数据
分割并可视化得到的血管模型；能够在血管模型中运动的导丝模型；用于供虚拟手术系统操作者
操纵模型中的导丝的物理的触觉操作机构。

此外，系统还需为上述功能提供友好、灵活的图形界面(GUI)；计算机软件系统与触觉操作机构之
间信息交流所需的通信子系统（在实际的开发工作中，该子系统属于触觉操作机构部分）。

血管模型需要满足的基本要求是：基本准确地分割并重建出若干不同病例的循环系统模型，能够
近乎真实地反映腹主动脉、冠状动脉以及心房与心室的结构，视觉效果上尽可能地与真实导管术
中的C-型臂X光投影仪的成像效果相近。

导丝模型需要满足的基本要求是：导丝应该具备同真实导丝的外观基本一致的可视化效果；导丝
还应具有足够的物理特性，使其在血管模型中运动时，能够表现出真实导丝基本一致的受力情况。

触觉操作机构需要满足的基本要求是：能够保证基本的操控性能，即准确地操纵导丝作进退和旋
转运动；具备触觉反馈功能。

如果上述基本要求能够在较短时间内顺利实现，则把工作的重心转移的实现系统的高级要求上来。
系统的高级特性包括：血管模型应具备与真实血管相近的弹性和形变特性；所重建的心脏区域
（指冠状动脉和心房与心室）可以虚拟心脏的搏动过程；实现"虚拟造影剂"，该特性在触觉操作
机构的激发下呈现，应当具有与真实手术过程中，医生通过导管向冠状动脉中注入造影剂时的视
觉效果应当一致；实现虚拟支架-气囊，使其能够像真实情况一样--在气囊内部被气体填充的过
程中，支架的结构发生变化、内径逐渐增大；操作过程记录；训练难度分级与训练评价等。

\subsection{解决方案}
\label{subsec1-1-3}

本部分将介绍构建血管模型的主要研究内容。

获得血管模型的基本过程是：
\begin{enumerate}
  \item CT数据集进行图像预处理；
  \item 从经过预处理的CT数据集中分割出属于血管模型的像素；
  \item 利用分割所得像素重建出血管模型。
\end{enumerate}
很明显，这个基本思路与实际应用中的CT成像设备的图像处理部分类似，只不过这里我们并不涉及
成像和存储部分。

对CT影像进行预处理，这包括：降噪、阈值、图像恢复、重采样、梯度计算、非线性映射、数学形
态学处理等方法。它们的作用是改善图像质量，突出感兴趣的图像细节，为后续的图像分割步骤提
供基础。

对进行过预处理的影像数据进行图像分割，图像分割是图像处理中的一项挑战性很强的任务。到目
前为止，都没有一种通用的方法能够应付多数的分割任务。图像分割方法有很多种，大致可分为：
基于区域的图像分割方法、基于边界的图像分割方法以及混合方法等。我们的候选方法是区域生长
法和Fast Marching方法。

区域生长法的基本思路是将具有相似性质的像素集中起来构成区域，该方法需要先在图像中选取一
个种子点，然后依次将种子像素周围的相似像素合并到种子像素所在的区域中。区域生长法的研究
重点一是特征度量和区域生长规则的设计，二是算法的高效性和有效性。区域生长法的优点是计算
简单，特别适合分割体积小或者结构相对简单的结构，如肿瘤、伤疤以及主干血管等。该方法的缺
点是需要人工交互以获得种子点，这样使用者必须在每个需要抽取出的区域中植入一个种子点。同
时，区域生长方法也对噪声敏感，导致抽取出的区域有空洞或者在局部体效应的情况下将原本分开
的区域连接起来。

Fast Marching法是一种基于几何形变模型的医学影像分割方法。几何形变模型的基础理论是曲线演
化理论和水平集方法。几何形变模型的基本思想是将曲线的形状变化用曲线演化理论来描述，即用
曲率或向量等几何亮度表示曲线或曲面演化的速度函数，并将速度函数与图像数据关联起来，从而
使曲线在对象边缘处停止演化。由于曲线的演化与参数无关，几何形变模型能自动处理对象拓扑的
关系，演化过程中的曲线和曲面只能被隐含表示为一个更高维函数的水平集，因此曲线演化过程采
用了水平集方法实现。而Fast Marching方法跟踪运动曲线或曲面的则是固定曲线或者曲面的演化方
向，也就是说，曲线或者曲面只能收缩或者只能扩张。

最后一步是在分割所得的模型像素的基础上，利用不同的绘制方法，在场景中渲染出分割所得到的
模型。绘制方法属于计算机图形学范畴，主要的绘制方法有两类：面绘制（或面渲染）和体绘制（
或体渲染）。本课题中的候选方法是Marching Cubes方法和Ray Casting方法。

Marching Cubes方法的基本原理是：采用隐式的等值面提取方法从体数据中获取等值的信息。算法
需要用户提供一个阈值，也就是所希望提取出来的物质的密度，然后根据体数据的信息，就可以把
相应阈值内的数据全部提取出来，并且通过三角网格表示出来。

Ray Casting方法的基本原理是：从投影平面的每一个像素点发射出一条光线，穿过三维体数据场，
并按照front-to-back的顺序进行采样点光属性的混合，最终得到二维投影图像。对于三维体数据场
中的采样点，可以用最近邻、三线性或样条函数的方法插值出其光属性。Ray Casting方法得到的可
视化效果比较好，立体感强，并且可以很好地实现一些插值算法和光线的提前终止，但是算法的速
度比较慢，目前还达不到实时的绘制目的。

\section{问题背景}

%本节叙述内容：
%\begin{enumerate}
%  \item 问题的社会背景
%  \item 问题的历史背景
%\end{enumerate}

\section{研究现状}

%本节叙述内容：
%\begin{enumerate}
%  \item 国外研究现状
%  \item 国内研究现状
%  \item 相关技术现状
%\end{enumerate}

本课题的发展已经持续了数年，由于在文化背景、公共卫生管理、医学和工程等诸多因素的影响，
我国在这方面的研究和应用与欧美发达国家的相应方面相比，尚有不小差距。具体表现在研究水平
和应用水平两个方面。下面将分别简要介绍近几年，国内外科研人员在本课题以及相关研究方向上
所作的主要工作和重要成果。

\subsection{国外研究现状}

本小节叙述内容：
\begin{enumerate}
  \item Singapore
  \item Johns Hopkins
  \item MedicalSim
  \item INIRIA
  \item Western Reserve
  \item Lecce
  \item CRaIVE
  \item ETH
  \item Japan
  \item Hong Kong
  \item Simense
  \item Mentice
  \item CathLabVR
  \item Simbionix
\end{enumerate}

国外的许多大学和研究机构在应用于各种类型手术的虚拟训练以及相关方向的研究起步较早，不少
研究成果已经成功转换为实际应用中的可靠系统，开始为医疗培训事业服务。第一个介入手术模拟
系统是由HT Medical公司开发的Dawson-Kaufman模拟器\cite{meglan1996making}。Immersion
Medical公司开发出一种用于训练护士学员完成静脉穿刺术的CathSim系统\cite{ursino1999cathsim}。
CIMIT研究中心的研究人员开发出了直接应用于心血管介入手术训练的ICTS系统\cite{cotin2000icts}。
德国曼海姆大学计算医学系研发了用于心脏导管介入手术训练的Cathi系统\cite{hofer2002cathi}。
荷兰癌症研究所的Alderliesten等人开发出一种用于模拟微创血管介入手术的MIVIS系统\cite{alderliesten2004simulation}。
德国卡尔斯鲁厄大学的研究人员于2008年成功实现了一种内嵌于显微镜中、用于脑神经外科微创介
入手术虚拟训练的系统\cite{mauro2008development}\cite{mauro2009virtual}。其他相关的典型
研究有：法国巴黎第六大学的研究人员开发了一种评价系统，它通过物理操作机构控制虚拟场景中
的目标物体，来检验一种手持式手术机器人的性能\cite{zahraee2009evaluating}。墨西哥国立自
治大学的研究人员于2009年设计并成功实现了一种用于虚拟前列腺微创介入手术的训练系统中的触
觉操作机构，结合计算机中的虚拟场景，该系统可以进行前列腺微创介入手术的演示和培训工作\cite{padilla2009virtual}。
我国学者马炘及其所属新加坡科技局国立生物医学图像研究所团队成功开发了团队内的第一个介入
手术模拟系统daVinci\cite{wang1996potential}\cite{chui1996potential}、用于介入式心
血管手术仿真的ICard系统\cite{wang1999realtime}\cite{chui1998icard}以及用于脑血管介入手
术仿真的NeuroCath系统\cite{anderson2001pc}\cite{chui2002training}\cite{ma2004computer}\cite{ma2006customable}。
香港中文大学的Simon, C. H. Yu等人成功研发了同样用于脑血管介入手术仿真的系统\cite{cuhkweb}。

目前，国外已有数家医学模拟器专业生产厂商成功开发出了可应用于血管微创介入导管术训练的产
品，主要有：瑞典的Mentice公司\cite{menticeweb}、美国的CAE公司\cite{caeweb}和Simbonix公
司\cite{simbionixweb}等。Mentice公司的代表产品是VIST, VIST-C以及MIST等，其中VIST已经能
够实现对微创介入手术的完整训练，该系统已经在医学界投入使用，对该系统的有效性方面的医学
统计研究已经展开\cite{duncan2006analysis}\cite{tedesco2008simulation}\cite{glaiberman2008simulation}；
CathLabVR是CAE研发成功的专业心血管微创介入导管术训练系统，该系统已经可以为受训者提供准
确的病理特征、触力反馈和视觉效果，CathLabVR也已应用于国外大型医学研究中心、医学院\cite{voelker2011improved}；
而Simbonix公司的ANGIO MENTOR系列系统则可以为从单个初学者到由若干初学者组成的学习小组等
不同规模的受训者提供微创介入手术训练服务\cite{hislop2009simulation}。

\subsection{国内研究现状}

本节叙述内容：
\begin{enumerate}
  \item 熊岳山
  \item 马炘
\end{enumerate}

近年来，随着我国社会经济的不断发展，国民生活水平也有了长足的提高，人们一方面享受到了较
好的物质条件带来的多方面的益处，一方面也由于缺乏端正的健康生活意识而出现了各种由于膳食
结构不合理、体力消耗水平过低而引起的疾病，其中以冠心病等心脑血管疾病为代表的人体循环系
统疾病的发病率和致死率呈逐年上升趋势，这一趋势已引起了医学界和公共卫生部门的高度重视。
正是这样，国内高校和科研院所近年开展与临床手术应用相关的生物工程项目不断增多。然而，由
于我国在相关方面的科研基础与发达国家存在差距，再加上我们在科研成果转化为实际应用方面的
滞后，目前，国内虚拟手术训练的研究仍较为初级。其中与本课题研究方向有一定关系的有：天津
大学的冯鹰\cite{li2005master}等人于2005年设计并实现了用于腹腔镜手术的虚拟训练系统；该
校的王树新等人\cite{zeng2006master}于2006年研究了面向显微外科手术的虚拟血管缝合仿真系
统。国防科技大学的熊岳山等人对虚拟心脏介入手术的相关方面进行了研究，如：几何模型构建技
术\cite{han2005master}、血流模拟和特效场景\cite{ren2005master}、弹簧-振子模型\cite{wang2006master}、
医疗器械的三维建模\cite{zhu2007master}以及碰撞检测技术\cite{kang2007master}等，最近已有
有成型系统的文献报道\cite{tan2012coronary}。上海交通大学的顾力栩等人开展了虚拟手术系统
中模拟手术场景的渲染和平台的创建工作\cite{zheng2008master}以及血管内血流模拟方面的工作\cite{huang2011virtual}；
该校的谢叻等人则在虚拟手术的碰撞检测\cite{wu2010virtual}和触力反馈\cite{wu2011virtual}
方面进行研究。

\subsection{相关技术现状}

本节叙述内容：
\begin{enumerate}
  \item 医学影像处理
  \item 医学可视化
  \item 组织建模与特性分析
  \item 器官的物理特性建模
  \item 虚拟解剖环境的建立
  \item 手术工具与解剖环境的交互
  \item 手术流程的建模
  \item 系统集成
\end{enumerate}

\section{本文工作}

%本节叙述内容：
%\begin{enumerate}
%  \item 研究工作目的
%  \item 论文内容布局
%  \item 组内相关工作
%\end{enumerate}

本文研究工作的目的是：以真实的心血管微创介入导管术为原型，利用计算机相关学科的知识和
技术，研究并实现一种能够以虚拟现实或增强现实的方式来模拟该原型的手术训练系统。该系统
应当具备友好的图形界面；提供为获得足够真实的感受所需的反馈，包括：视觉方面，足够真实
的，与介入式导管术相关的人体解剖结构，以及在外观和物理特性方面足够真实的手术器械（即
导管）；触觉方面，提供与虚拟环境中的视觉反馈相一致的触觉感受，如：导管在进给过程中，
若其顶端触碰到血管壁，操控者手持的触觉接口则会向其提供一个阻力的感受，使操控者仿佛真
实地感受到自己手中操控的导管的顶端碰到了血管的内壁一样。在这样一个过程中，我们所研发
的系统足以为操控者提供一个足够真实具体的手术环境，从而使学员能够获得与其在真实生物体
上进行手术相近的体验，学到远比教科书讲授内容更为真切的技能；使有经验的医师能够在开展
真实手术之前，演练并验证自己的手术方案，提高手术的成功率。

本文的内容编排的原则是开篇介绍本研究项目的基本情况，以及与本研究项目有关的研究进展；
之后的每章叙述一个导管术训练系统的关键技术环节；最后一章总结我们在研究工作中的成果、
经验，与教训，并展望本项目未来的一些可能的发展动向。全文分为十章：第一章是全文绪论，
概括介绍本项目的研究动机、研究背景、以及本文的主要内容，详细描述与本文所述工作相关的
典型样机和关键技术在国内外研究情况和发展历史；第二章是医学背景介绍，比较详细地记述了
与本文所述工作相关的医学知识，包括介入心脏病学和医学影像技术等内容；第三章是血管模型
的提取，介绍了为从CTA中获得血管系统所对应的像素信息所进行的主要工作以及工作成果，详
细描述本环节工作所用到的关键技术内容；第四章是血管模型的可视化，介绍了在第三章工作基
础上获得血管系统的可视化模型所进行的主要工作以及工作成果，深入描述了本环节工作所用到
的关键技术内容；第五章是心脏模型的提取与可视化，介绍了基于CTA的心脏模型的分割与可视
化工作和工作成果，描述了本环节工作所用到的关键技术内容；第六章是组织的物理特性建模，
具体介绍了器官组织物理特性的分析与建模过程；第七章是手术过程中特殊动态效果的实现，描
述了为实现诸如虚拟造影剂、可视化模型的X光显示等可视效果而做的工作，展示了工作成果；
第八章是手术流程的状态机模型研究，主要介绍将冠状动脉导管术的流程进行计算机建模的一种
方法；第九章是软件系统的整合，记录了一些笔者在本研究项目过程中对软件工程的一些思考；
第十章是总结与展望，客观、全面地总结全文内容，概括本研究项目所取得的工作成果，列出在
此过程中表现出来的一些教训，最后对本研究工作的未来发展做了一些预测。

本文所述工作是“经皮介入冠脉导管术仿真系统的设计与研究”的一部分，工作任务涉及血管系
统和心脏等解剖结构的场景生成和仿真。关于该仿真系统中的手术工具的物理建模与仿真，请参
考组内同事米韶华的博士学位论文《XXX》以及相关的已发表科技文章。

本文所述工作获得了XXX基金的大力支持。在此，笔者谨代表其所在的研究团队向XXX基金组织表
示由衷的感谢！ 