%# -*- coding:utf-8 -*-
\chapter{绪\;\;\;论}
\label{chap1}

第二次世界大战后，世界政治经济的整体状况趋于稳定。在各国政府的政策引导下，人民饱享经
济长期稳定发展、生活水平稳步提升的硕果，而由此带来的生存环境和生活方式的剧烈变化却导
致心血管疾病等慢性疾病成为全世界范围最大的流行病\cite{Hu2009}。心血管疾病的形成与个
人日常生活中的不良习惯有关，如：吸烟，缺乏体育运动，不健康的饮食习惯，以及超重和肥胖
等\cite{Go2013}。从生理上讲，促使心血管疾病形成的因素有很多，但大多与动脉粥样硬化有
关。动脉粥样硬化由血液成分的变化引起，当血液中累积过多的脂肪类物质、胆固醇、细胞代谢
产生的废物，钙盐，以及纤维蛋白等成分时，就会逐渐附着于血管内壁，最终形成斑块甚至血栓，
这些血管内壁上的异物影响血流通畅，最终导致血管疾病\cite{cvdaha}。目前，以冠心病为代
表的心血管疾病的防控形势严峻，据世界卫生组织2010年的报告\cite{mho2011}称，心血管疾病
已成为全球人口的首要死因。2008年，约有$1730,0000$人死于心血管疾病，约占当年全球死亡
人数的30\%，其中超过80\%的死亡人口来自中等收入国家和低收入国家\cite{mho2011}。卫生部
的相关报告\cite{moh2010annual}\cite{moh2007annual}\cite{moh2004annual}显示，在我国的
城市和乡村，冠心病的死亡人数正在逐年攀升。在美国，心血管疾病的死亡数字虽然在相当长一
段时间（1999年～2009年）内呈下降趋势，但是由这种疾病所造成的经济负担依然沉重\cite{Go2013}。
面对这一现实，提高心血管疾病的诊疗水平成为公共卫生管理者和心血管内科学领域的医学工作
者的共同目标。使人类远离疾病困扰、享受健康生活的天然使命促使医学界不断提出新的诊疗方
法和药物配方。其中，以经皮冠状动脉介入术\cite{Baim2005}为代表的微创介入手术疗法是目
前心血管内科学领域普遍采用的、用于治疗冠心病、动脉狭窄、钙化以及动脉血管瘤等病症的有
效方法之一，它具有切口小、创伤轻、痛苦少、恢复快等优点，是广大心血管疾病患者的福音。

\section{问题声明}
\label{sec1-1}

\subsection{问题的提出}
\label{subsec1-1-1}

经皮冠状动脉介入术仿真训练系统是一个以实现主要功能的软件系统为核心，辅以为受训者提供
操作对象的触觉操作机构而成的一个功能完整的混合系统。该系统能够为受训者提供充分的真实
性，使受训者能够“沉浸”在平台所提供的场景中，按照所学的手术技术进行仿真实践，通过这
一过程进一步了解手术流程、获得对手术技术更为形象的认识。

与经皮冠状动脉介入术仿真训练系统有关的关键技术包括解剖环境的创建、手术工具的创建、以
及触觉接口的设计与制造等方面。本文的研究重点是解剖环境的创建，其中包括以下几个问题：
基于CTA的血管系统几何模型的建立；基于CTA的心脏可视化模型的建立；器官组织的力学特性分
析与建模；手术仿真的增强性效果的研究；手术流程的建模等。

血管几何模型需要满足的基本要求是：基本准确地分割并重建出若干不同病例的血管系统模型，
且能够近乎真实地反映腹主动脉、冠状动脉等血管的主要脉络的几何拓扑结构。

心脏模型需要满足的基本要求是：尽可能准确地分割并重建出相应病例数据中的心脏模型，与血
管几何模型实现准确的叠加，视觉效果尽可能与X光成像效果相近。

器官组织的力学特性分析与建模的基本要求是：

手术仿真的增强性效果的研究目标是实现一系列的视觉特效，以表现仿真训练过程中的一些视觉
效果（如真实导管术中的C型臂X光投影仪的成像效果）、人体的正常生理反应（如呼吸、心脏搏
动等），和手术操作效果（如虚拟造影剂）等，从而改善仿真的真实性。

手术流程建模的目的是在充分分析经皮冠状动脉介入术的正常完整流程的基础上，利用有限状态
机原理将整个流程进行状态化的建模。

\subsection{术语解释}
\label{subsec1-1-2}

\textbf{图像分割}

\textbf{可视化}

\textbf{渲染}

\subsection{解决方案}
\label{subsec1-1-3}

本部分将介绍构建血管模型的主要研究内容。

获得血管模型的基本过程是\cite{Preim2008Review}：
\begin{enumerate}
  \item CT数据集进行图像预处理；
  \item 从经过预处理的CT数据集中分割出属于血管模型的像素；
  \item 利用分割所得像素重建出血管模型。
\end{enumerate}
很明显，这个基本思路与实际应用中的CT成像设备的图像处理部分类似，只不过这里我们并不涉及
成像和存储部分。

对CT影像进行预处理，这包括：降噪、阈值、图像恢复、重采样、梯度计算、非线性映射、数学形
态学处理等方法。它们的作用是改善图像质量，突出感兴趣的图像细节，为后续的图像分割步骤提
供基础。

对进行过预处理的影像数据进行图像分割，图像分割是图像处理中的一项挑战性很强的任务。到目
前为止，都没有一种通用的方法能够应付多数的分割任务。图像分割方法有很多种，大致可分为：
基于区域的图像分割方法、基于边界的图像分割方法以及混合方法等。我们的候选方法是区域生长
法和Fast Marching方法。

区域生长法的基本思路是将具有相似性质的像素集中起来构成区域，该方法需要先在图像中选取一
个种子点，然后依次将种子像素周围的相似像素合并到种子像素所在的区域中。区域生长法的研究
重点一是特征度量和区域生长规则的设计，二是算法的高效性和有效性。区域生长法的优点是计算
简单，特别适合分割体积小或者结构相对简单的结构，如肿瘤、伤疤以及主干血管等。该方法的缺
点是需要人工交互以获得种子点，这样使用者必须在每个需要抽取出的区域中植入一个种子点。同
时，区域生长方法也对噪声敏感，导致抽取出的区域有空洞或者在局部体效应的情况下将原本分开
的区域连接起来。

Fast Marching法是一种基于几何形变模型的医学影像分割方法。几何形变模型的理论基础是曲线演
化理论和水平集方法。几何形变模型的基本思想是将曲线的形状变化用曲线演化理论来描述，即用
曲率或向量等几何亮度表示曲线或曲面演化的速度函数，并将速度函数与图像数据关联起来，从而
使曲线在对象边缘处停止演化。由于曲线的演化与参数无关，几何形变模型能自动处理对象拓扑的
关系，演化过程中的曲线和曲面只能被隐含表示为一个更高维函数的水平集，因此曲线演化过程采
用了水平集方法实现。而Fast Marching方法跟踪运动曲线或曲面的则是固定曲线或者曲面的演化方
向，也就是说，曲线或者曲面只能收缩或者只能扩张。

最后一步是在分割所得的模型像素的基础上，利用不同的绘制方法，在场景中渲染出分割所得到的
模型。绘制方法属于计算机图形学范畴，主要的绘制方法有两类：面绘制（或面渲染）和体绘制（
或体渲染）。本课题中的候选方法是Marching Cubes方法和Ray Casting方法。

Marching Cubes方法的基本原理是：采用隐式的等值面提取方法从体数据中获取等值的信息。算法
需要用户提供一个阈值，也就是所希望提取出来的物质的密度，然后根据体数据的信息，就可以把
相应阈值内的数据全部提取出来，并且通过三角网格表示出来。

Ray Casting方法的基本原理是：从投影平面的每一个像素点发射出一条光线，穿过三维体数据场，
并按照front-to-back的顺序进行采样点光属性的混合，最终得到二维投影图像。对于三维体数据场
中的采样点，可以用最近邻、三线性或样条函数的方法插值出其光属性。Ray Casting方法得到的可
视化效果比较好，立体感强，并且可以很好地实现一些插值算法和光线的提前终止，但是算法的速
度比较慢，目前还达不到实时的绘制目的。

\section{研究动机}
\label{sec1-2}

文献：
\begin{itemize}
  \item 临床证据\cite{Aggarwal2006}
  \item
\end{itemize}

传统的外科教学方式可以概括为“师傅-学徒”模型 --- 这与人类其他领域的知识和技艺的传承方
式并无二致，用西方医学界的习语来比喻，就是“见一个，做一个，教一个”（英文原文是：see
one, do one, teach one）\cite{Dawson1998}。见习者通过最真实的实践来获得技能。这个过程
需要在动物，遗体，志愿者，以及病人身体上进行。动物的解剖结构与我们人类的不同，遗体不
能呈现真实的生理反应，而在志愿者或者病人身体上进行实践学习，又会给他们的生命带来风险\cite{liu2003}。
再者，所有这些实践活动都是在见习单位的既定安排等因素的约束下进行的，实践学习无法重复，
无法自行把握时间和地点，这给手术技术的传播和推广制造了障碍。

相较于传统手术，介入式导管术具有一定的局限性\cite{basdogan2007}。这从客观上导致了进行
这种手术和学习这种手术的难度。

首先是进行手术的难度。在整个介入式手术过程中，医生无法直接通过肉眼观察手术器械的精确
位置、而只能通过X光成像来判断器械的当前位置并估计下一步的运动方向，这给医生的手眼协调
造成了障碍；手术工具只能在血管管腔内进行旋转和进退运动；医生从手术工具获得的触感有限，
不利于判断手术工具是否与血管壁发生接触、甚至碰撞。

其次是手术培训的问题。为了得到充分的训练，见习人员的培训时间较长，能否在手术室中
观察真实手术完全取决于有没有相关病症的病人，使这样的机会变得非常珍贵，而目前不断上涨
的卫生医疗支出迫使医疗机构不断压缩学时，又加剧了这个问题\cite{liu2003}。另外，对医生
手术技术的评估缺乏客观的、标准的方法和流程。整个评估过程中，被评估者的操作水平由经验
丰富的高级医务人员进行观察和判断，这存在着主观性，不利于训练质量水平的控制\cite{basdogan2007}。

关于介入式手术，医学界尚未对采用何种方式更为高效取得一致看法\cite{basdogan2007}。
于是，在美国和欧洲，许多在相关医学技术领域处于领先地位的高级研究机构先后建立了专门的
训练中心，用于在培训相关人员的同时，研究更加行之有效的训练方式，并陆续设计开发了许多
实物仿真训练模型，包括静态模型和动态模型。这些模型提供了真实的手术工具、显示器、以及
塑料制成的人体组织模型。然而，这些模型缺乏足够的真实性，而且，我们仍然无法客观评估在
这些模型上进行训练的见习人员的技术水平。

基于计算机虚拟现实技术的手术仿真训练技术应运而生，它可以为受训人员提供与手术相关的触
觉、视觉等感官信息，让受训人员可以像在进行真正手术一样完成训练，而无需借助过多的真实
物料、无需依赖所在单位的时间安排。训练的整个过程可由计算机进行记录并评估，为实现训练
评估的客观性和标准化提供了技术支持。我们把这种虚拟的手术训练方式称为“虚拟手术”。

%为了能够给更多的心血管病患提供手术治疗，对相关专业方向的医生、医学院学员以及从
%事相关领域的工程研究的科研人员的训练变得更加重要。传统的手术训练需要在活体动物
%或者死者捐献的遗体上进行，但是，这类训练方式不仅成本高、不具备可重复性，而且对
%实验场所和参加训练的人员的卫生条件要求都比较严格，因此，这种训练并不能很方便地
%开展，这也相应地影响了心血管内科专业的发展。如果我们能够为这些人员提供一种能够
%克服这些"实际"障碍的训练方式，那么开展这类专业训练、培训和演示将会变得方便、灵
%活、经济和安全。这种手术训练方式我们称之为"虚拟手术(Virtual Surgery)"。

所谓“虚拟手术”，就是指进行这种活动的人，在事先设计好的虚拟或半虚拟的“场景”中，利
用这个场景中所呈现出的视觉、听觉甚至触觉的反馈，在体外进行预定的“手术活动”，从而达
到熟悉手术完整流程、理解手术操作细节的目的。在这个过程中，我们不需要向操作者提供活体
动物或者死者遗体、不需要无菌的实验室环境、更不需要任何辅助设施和材料，并且还能在任何
时间进行操作，所有看得见的设备就是一台计算机和一套触觉接口（Haptic Interface）。整个
系统的核心与关键是运行在这台计算机上的软件系统，它为操作者提供充分的视觉反馈信息。实
现“虚拟手术”的设备称为“虚拟手术系统”，该系统是一个多学科交叉结合的产物，它应用了
系统工程、材料工程、机器人工程、图像处理、计算机图形学、计算机科学、生物医学工程、医
学等学科。该系统首先从真实病例的CT影像数据中分割出手术途经的血管和病灶，然后基于此数
据进行渲染获得这些血管的可视化模型（下文中，在不致产生歧义的地方将一律采用“血管模型”
来代替的关于虚拟血管模型的所有称谓），接着将基本拟合真实力学特性的虚拟导丝/导管模型
（下文中，在不致产生歧义的地方将一律采用“导丝”来代替此处的“导丝/导管”）引入该模
型，由操作者通过触觉接口依据微创介入导管术的规程进行操作；在操作过程中，操作者通过触
觉接口操纵导丝模型在血管模型中进退和旋转，并能够获得类似于真实手术的触觉感受。与本研
究方向紧密相关的一个方向是图像引导手术机器人，二者之间最显著的不同之处在于是否具有真
正的作用对象：虚拟手术仅仅提供触觉接口作为操作者的操作对象；而图像引导手术机器人则是
在真实的患者身体上进行手术操作。然而，虚拟手术系统为操作者提供的有效操作动作与真实的
手术中的主要动作完全一致，从而保证了手术训练的有效性。虚拟手术系统的研究和实现的最终
目的，就是为心血管内科医生和相应专业的学员、以及从事相关研究的生物医学工程科研人员提
供一种安全、有效、方便、经济的训练方式和演示方式。医生和学员可以在这种系统的帮助下，
学习、熟悉并初步掌握心血管微创介入导管术的操作流程、技术细节；科研人员可以在操控这种
系统的过程中，了解微创介入导管术，并继续完善已有系统、甚至设计和实现性能更加出色的系
统。再者，如果添加部分特性和功能，本系统有可能可以很方便地扩展为图像引导手术机器人的
图像引导系统。

\section{研究现状}
\label{set1-3}

%本节叙述内容：
%\begin{enumerate}
%  \item 国外研究现状
%  \item 国内研究现状
%  \item 相关技术现状
%\end{enumerate}

在军事和工业领域，基于虚拟现实的仿真技术在训练、以及评估在特定环境下使用者解决问题的反应等方面，已经显示了重大的实际价值\cite{Goodwin1978Simulator}\cite{Rolfe1986Simulators}\cite{Ressler1999Simulators}\cite{Wachtel1985Simulators}\cite{Liu2013Military}。
经过数十年时间的发展\cite{Dawson1998}，仿真技术在医学、尤其是医学训练领域的应用也已经比较广泛，包括内窥镜\cite{Vining1995Endoscopy}\cite{Preminger1996Endoscopy}、神经医学\cite{Kockro2000Neurosurgery}\cite{Cotin2005EVE}\cite{Ma2007NeuroCath}、麻醉学\cite{Gaba1988Anesthesiology}、支气管镜\cite{Vining1996Bronchoscopy}、腹腔镜\cite{Hon1994Laparoscopy}\cite{Derossis1998Laparoscopy}、以及心血管和外周血管系统的介入手术\cite{Chui1998ICard}\cite{Cotin2000ICTS}\cite{Tan2012NUDT}等。
2004年，美国食品药品监督管理局（FDA）决定，行颈部血管介入手术等高风险手术的医生，必须在术前进行技能训练，直到精通为止，而且对这种技能的初期训练实践不能在病人身上进行\cite{Dawson2006Medicine}。

受经济、文化、公共卫生管理、医学和工程技术等诸多因素的制约，我国在这方面的研究和应用与欧美发达国家相比，尚有不小差距，具体表现在研究水平和应用水平上。本节将分别介绍近几年，国内外科研人员在虚拟医学训练、
尤其是血管介入术虚拟训练以及相关研究方向上所作的主要工作和重要成果。

\subsection{国外研究现状}
\label{sec1-3-1}

本小节叙述内容：
\begin{itemize}
  \item Singapore--Johns Hopkins：
  \cite{chui2002simulation}
  \cite{cai2003}\cite{cai2004}\cite{cai2006}
  \cite{Li2007}\cite{Li2006}
  \cite{Chiang2011}
  \item EPFL：
  \item CIMIT/MedicalSim（ICTS）：
  \item INIRIA（EVE）：
  \item CRaIVE：
  \item Stanford：
  \item Western Reserve：
  \item Netherlands：
  \item Lecce（HERMES）：
  \item CRS4（ViVa）：\cite{abdoulaev1998}\cite{Zorcolo2000}\cite{Gobbetti1998}\cite{Gobbetti2000}\cite{Zorcolo1999}
  \item Japan
  \item Hong Kong
  \item Siemens（CathI）：
  \item Mentice：\cite{menticeweb}
  \item CathLabVR：\cite{caeweb}
  \item Simbionix：\cite{simbionixweb}
  \item SimSuite：\cite{simsuiteweb}
  \item \cite{Rahman2012}
\end{itemize}

最早出现的介入放射学仿真系统之一是美国HT Medical公司开发的Dawson-Kaufman血管介入放射学虚拟系统\cite{Higgins1995DK}\cite{Dawson1996DK}\cite{meglan1996DK}。
该系统首先用于腹主动脉介入的仿真\cite{Wang1998ICard}。
系统所提供的解剖环境基于真实病例的影像，并在此基础上重建了血管的静态刚性模型，整个解剖环境模型被渲染成与术中X光影像类似的显示效果以提高仿真的真实性\cite{Higgins1995DK}。
同时，该系统还能够通过专门设计的触觉接口装置为使用者提供“真实”的导丝操作感受\cite{BroNielsen1997DK}。
通过这些技术，Dawson-Kaufman介入放射学虚拟系统为使用者提供了实践血管成形术和其它疏通阻塞血管的技术的训练平台。

同时出现的还有新加坡国立大学和美国约翰-霍普金斯大学医学院共同研究与实现的用于腹部主动脉介入仿真训练的daVinci系统（\textbf{\textit{Vi}}sual \textbf{\textit{n}}avigation of \textbf{\textit{c}}atheter \textbf{\textit{i}}nsertion\cite{Lawton2000daVinci}）\cite{Anderson1996daVinci}\cite{Anderson1996adaVinci}\cite{Anderson1997daVinci}\cite{Anderson1997adaVinci}。
该系统利用了美国“可视人计划”（\textbf{\textit{V}}isible \textbf{\textit{H}}uman \textbf{\textit{P}}roject, VHP）\cite{vhpweb}的人体数据，通过与X光效果的解剖背景配准的仿真血管模型，向使用者提供实时的平面可视效果以及立体的导管导航\cite{Anderson1998daVinci}。
血管壁由包围血管壁的内部区域的势能场来表示，这个势能场决定了导管和血管壁之间相互作用的能量，
导管的建模方法采用有限元方法，把导管抽象为六自由度的梁元\cite{Chui1996daVinci}\cite{Wang1996daVinci}。
虚拟导管的材料特性通过杨氏模量和切变模量来体现，其中忽略了导管与血管壁之间的摩擦力\cite{Anderson1998daVinci}。
Lawton等人\cite{Lawton2000daVinci}还开发了一种物理模型和数值算法，用于仿真导管插入动脉系统并推进的过程。

几乎与此同时，开发daVinci的科研团队在前期工作的基础上，实现了用于心血管介入仿真训练的ICard系统（\textbf{\textit{I}}nterventional \textbf{\textit{Card}}iology Simulator）\cite{Wang1997ICard}\cite{Chui1998ICard}\cite{Wang1998ICard}，
以及用于脑血管介入仿真训练的NeuroCath系统（\textbf{\textit{Neuro}}radiology \textbf{\textit{Cath}}erization Simulator）\cite{Ma2000NeuroCath}\cite{Nowinski2000NeuroCath}\cite{Ma2001NeuroCath}\cite{Li2001NeuroCath}\cite{Nowinski2001NeuroCath}\cite{Anderson2001NeuroCath}\cite{Chui2002NeuroCath}\cite{Anderson2002NeuroCath}\cite{Ma2004NeuroCath}\cite{Volkau2005Vessel}\cite{Ma2005NeuroCath}\cite{Ma2006NeuroCath}\cite{Ma2006aNeuroCath}\cite{Ma2007NeuroCath}。

ICard系统的应用目的是为医学院学生和医生提供一个能够方便地温习心血管介入疗法的平台，同时还希望兼顾评价使用者的技能水平。
该系统的软件部分提供了血管的立体模型和X光效果的显示\cite{Wang1998ICard}\cite{Wang1998aICard}。
血管的影像数据主要来源于VHP。
对于手术涉及的主干血管，限于当时计算机的处理能力，研究团队使用Adobe Systems公司的Photoshop从每张横切影像中将感兴趣的区域中的血管影像的围线标出，然后再计算血管的中心线，最后结合中心线上各点的坐标和相应的半径，得到血管的模型\cite{Wang1998ICard}。
对于病灶涉及的冠状动脉，由于尸体的血管内并没有血液流动以及因此产生的压力，因此这部分较细的血管就会因为其周围肌肉组织的挤压而导致严重变形，这也就造成VHP数据中，冠状动脉的数据几乎全部被破坏\cite{Wang1998ICard}。
为了解决这个问题，该团队的研究人员利用三次元量床（\textbf{\textit{C}}oordinate \textbf{\textit{M}}easuring \textbf{\textit{M}}achine，CMM）\cite{CMMweb}来扫描冠状动脉的钢质模型\cite{KyotoModelweb}，从而获得包括完整冠状动脉分支的血管网络，再经过后期的细部处理，得到满足系统要求的冠状动脉血管模型\cite{Wang1998ICard}。
此外，ICard系统还提供了人体的脑血管模型\cite{Serra1997Vessel}\cite{Poston1995Vessel}，而脑部影像数据是一组核磁共振血管影像\cite{Wang1998ICard}。
然后，他们通过配准将上述的心脑血管模型与VHP中的主干血管模型连接在VHP数据构建的解剖环境中来获得完整的血管模型\cite{Wang1998ICard}。
至于导管的建模，该系统同样采用了有限元方法\cite{Wang1998ICard}。
在操作方式上，ICard提供了两种不同的操作：一种是计算机界面，另一种是物理装置界面\cite{Wang1998ICard}。
前者可以使使用者通过点击图形界面上的按钮来操作虚拟手术器械；后者则通过专门设计的物理装置（导管移动传感装置，\textbf{\textit{C}}atheter \textbf{\textit{M}}ovement \textbf{\textit{S}}ensor device, CMS）来操作\cite{Lim1998ICard}\cite{Lim1997ICard}。
ICard的软件系统所支持的功能包括X光影像显示、立体影像显示与横切面显示、生物医学信号模拟、球囊与支架的植入、以及诸如造影剂的注射等\cite{Wang1998ICard}。

为获得NeuroCath系统的脑血管模型，Cai等人\cite{Cai2003Vessel}采用了一种利用扫描和混合操作以生成血管段和分岔的结构性方法；Volkau等人\cite{Volkau2008Vessel}\cite{Volkau2005Vessel}提出了。
NeuroCath最初在约翰-霍普金斯大学医学院进行了验证。随后还获得了包括德国萨尔大学诊断介入神经放射学诊所、中国北京宣武医院、以及德国国立信息技术研究中心等医院和研究机构的许可。并获得了比较满意的反馈\cite{Ma2007NeuroCath}。

为给使用者提供交互的工具，研究人员还设计并实现了血管介入仿真专用的触觉及影像控制设备TiC\cite{Chui1999TiC}\cite{Ma1999TiC}，它由触觉子系统和影像操作子系统等两个主要部分组成。
前者可以使操作者能够操作导管和导丝进行与真实血管介入手术中类似的运动；后者则通过一台虚拟工作站来操作可视界面中提供的X光影像的视角。
此外，科研团队还设计并开发了若干CAD软件，它们分别用于导管等血管介入器械，如：CathWorks\cite{Cai1998CathWorks}\cite{Cai2000CathWorks}，和DCSM\cite{Li2001DCSM}等； 以及血管等人体器官的建模的CAD软件工具，如：Vascular Editor\cite{Ma2007NeuroCath}等。

位于美国麻省的三菱电气实验室（Mitsubishi Electric Research Laboratories，MERL）\cite{merlweb}和美国创新微创疗法中心（Center for Innovative Minimally Invasive Therapy，CIMIT）\cite{cimitweb}联合发起的ICTS项目\cite{Dawson2000ICTS}\cite{Cotin2000ICTS}\cite{Shaffer1999ICTS}。
ICTS的全称是“Interventional Cardiology Training System”（介入心脏病学训练系统），该系统旨在为学习者提供训练平台，并为引入新的医学器材和手术方法提供展示平台\cite{Cotin2000ICTS}。
ICTS实现了X光效果的解剖环境、建立了导管的物理模型和血液流动模型、并制作了触觉接口装置\cite{Cotin2000ICTS}。
此外，该系统还实现了一种手术学习机制“Virtual Rounds”\cite{Shaffer1999ICTS}，该学习机制复现了心血管介入手术的基本步骤，为使用者的训练评估提供了基础。
文献\cite{Dawson2000ICTS}中提到，ICTS系统当时正准备在欧洲投入其首次训练试验。

CIMIT的MedicalSim小组\cite{medicalsimweb}和法国INRIA的Shacra团队\cite{shacraweb}联合开发的EVE项目\cite{Luboz2005MedicalSim}\cite{Wu2005MedicalSim}\cite{Cotin2005EVE}\cite{Duriez2006EVE}\cite{Lenoir2006EVE}\cite{Wu2007EVE}\cite{dequidt2007}。
EVE项目研究并开发了一种用于仿真脑血管介入手术的系统。该系统提供了具有X光显示效果的头颈部解剖模型\cite{Luboz2005MedicalSim}，具有实时的碰撞检测和碰撞响应的导管有限元模型\cite{Duriez2006EVE}，血流动力学模型\cite{Wu2007EVE}，以及虚拟造影剂等视觉效果。
还设计了专用的触觉接口装置ABEL和专用的径向跟踪装置Cain\cite{medicalsimweb}。

英国CRaIVE\cite{Coles2010CRaIVE}\cite{Coles2011CRaIVE}\cite{Coles2009CRaIVE}\cite{Luboz2008CRaIVE}\cite{luboz2009CRaIVE}\cite{Luboz2010CRaIVE}\cite{Luboz2009aCRaIVE}\cite{Wu2011MedicalSim}。

日本理化学研究所\cite{takashima2009RIKEN}\cite{takashima2007RIKEN}。

日本名古屋大学\cite{Arai1996Nagoya}\cite{Ikeda2005Nagoya}。

荷兰列文胡克癌症研究所的MIVIS项目\cite{Konings2003NKI}\cite{alderliesten2002NKI}\cite{alderliesten2004NKI}\cite{alderliesten2007NKI}\cite{alderliesten2007aNKI}\cite{Bosman2005NKI}。

德国曼海姆大学的CathI\cite{rebholz2004cathi}\cite{Hoefer2002CathI}。

意大利莱切大学的HERMES项目\cite{aloisio2006HERMES}\cite{aloisio2004HERMES}\cite{aloisio2006aHERMES}\cite{aloisio2005HERMES}。

瑞士洛桑联邦理工学院机器人系统实验室设计并实现了一种用于仿真脑血管介入手术的系统\cite{Wang2007EPFL}\cite{Ilic2005EPFL}\cite{Moix2005EPFL}\cite{Ilic2005aEPFL}\cite{Ilic2005bEPFL}。
该系统的研究工作提出了一种基于物理特性的线形模型，以及一种快速碰撞检测策略\cite{Wang2007EPFL}。
前者所体现的仿真物理特性模拟了导丝的弹性特征，后者可以提供连续的碰撞检测，这与中心线方法相比，能够揭露出血管壁表面的更多细节。
同样地，该系统也提供了X光显示效果的解剖环境。
此外，该实验室还设计并实现了用于脑血管介入手术仿真的4自由度触觉接口装置\cite{Ilic2005EPFL}\cite{Moix2005EPFL}\cite{Ilic2005aEPFL}。
通过实验测量了血管介入手术中，血管因球囊膨胀过程中的弹性模量\cite{Ilic2005bEPFL}。
根据文献\cite{Wang2007EPFL}，该系统的下一步工作将是计算机仿真部分与触觉接口装置的整合。

日本香川大学工学部的郭书祥等人研究并实现了用于脑血管介入手术仿真的系统\cite{Gao2012GUO}\cite{Gao2012aGUO}\cite{Gao2012bGUO}。

香港中文大学\cite{cuhkweb}\cite{guo2007CUHK}\cite{Chui2010CUHK}。

美国HT Medical公司开发的CathSim系统用于仿真外周静脉内导管术\cite{ursino1999cathsim}，以及护士技术中的静脉穿刺\cite{Barker1999CathSim}。

\cite{Hahn1998Vena}。

%最早的介入放射学模拟系统是由美国HT Medical公司开发的Dawson-Kaufman模拟器\cite{Dawson1996}
%\cite{meglan1996making}，以及由新加坡国立大学信息增强医学中心（CieMed，NUS）与美国霍普
%金斯医学院合作研究开发的daVinci系统和ICard系统，其中，前者用于外周血管（如：腹主动脉）的
%介入仿真，后者用于心血管的介入仿真。
%
%随后不久，位于美国麻省坎布里奇市的三菱电气实验室（MERL）联合美国的医学与创新技术集成中
%心（CIMIT）发起了开发专门用于心血管介入手术训练的ICTS系统的研究计划。后来，该计划由来自
%英国和比利时的两家公司最终完成，并由瑞典的Mentice公司实现了该系统的商业化、并将其命名为
%Mentice VIST。
%
%新加坡国立大学和美国霍普金斯医学院将之前的一系列合作研究成果的应用范围扩展到了脑血管、
%外周血管、和心血管等人体的主要血管系统\cite{anderson2002}。文献\cite{Nowinski2001}\cite{Li2001}
%报告了脑血管介入手术仿真系统NeuroCath的最初情况。在该合作项目求学和工作的我国学者马炘
%报告了该系统的研究工作的最新进展\cite{ma2007}\cite{Ma2010}。在深圳开展的工作可以参阅文献
%\cite{Wang2012}\cite{Li2012}\cite{Wu2011}。
%
%德国曼海姆大学计算医学系研发了用于心脏导管介入手术训练的CathI系统\cite{hofer2002cathi}\cite{rebholz2004cathi}。
%荷兰癌症研究所开发出一种用于模拟微创血管介入手术的MIVIS系统\cite{alderliesten2004}。
%意大利莱切大学主持了HERMES项目，其目的是研究用于冠状动脉支架植入手术的虚拟训练系统\cite{aloisio2005}。
%
%大部分血管介入疗法的起始步骤都是用特制的工具穿刺进入人体的血管，即Seldinger穿刺术\cite{seldinger1953}。
%但是为了降低复杂性和成本，目前的商用化仿真器均未提供此步骤的仿真\cite{coles2011}。早期
%的工作成果来自美国Immersion Medical公司，他们开发了一种用于训练护士学员完成静脉穿刺术
%的CathSim系统\cite{ursino1999cathsim}。最近，由英国的CRaIVE小组研究并实现的血管外科手
%术平台（VSP，Vascular Surgery Platform）\cite{luboz2009}也致力于填补这一空白。目前该平
%台的验证研究正在进行。
%
%国外的许多大学和研究机构在应用于各种类型手术的虚拟训练以及相关方向的研究起步较早，不少
%研究成果已经成功转换为实际应用中的可靠系统，如：德国西门子公司的CathI系统\cite{hofer2002cathi}
%\cite{rebholz2004cathi}、瑞典Mentice公司\cite{menticeweb}的VIST、VIST-C以及MIST、美
%国CAE公司\cite{caeweb}的CathLabVR系统、以及美国SImbionix公司\cite{simbionixweb}的Angio
%Mentor系列等。其中，VIST已经能够实现对微创介入手术的完整训练，该系统已经在医学界投入使
%用，对该系统的有效性方面的医学统计研究已经展开\cite{duncan2006analysis}\cite{tedesco2008simulation}
%\cite{glaiberman2008simulation}；美国CAE公司\cite{caeweb}的CathLabVR系统，该系统已经可
%以为受训者提供准确的病理特征、触力反馈和视觉效果，CathLabVR也已应用于国外大型医学研究
%中心、医学院\cite{voelker2011improved}；美国Simbionix公司\cite{simbionixweb}的ANGIO
%MENTOR则可以为从单个初学者到由若干初学者组成的学习小组等不同规模的受训者提供微创介入手
%术训练服务\cite{hislop2009simulation}。
%
%
%\sout{德国卡尔斯鲁厄大学的研究人员于2008年成功实现了一种内嵌于显微镜中、用于脑神经外科微创介入手术虚拟训练的
%系统\cite{mauro2008development}\cite{mauro2009virtual}。其他相关的典型研究有：法国巴黎
%第六大学的研究人员开发了一种评价系统，它通过物理操作机构控制虚拟场景中的
%目标物体，来检验一种手持式手术机器人的性能\cite{zahraee2009evaluating}。墨西哥国立自治
%大学的研究人员于2009年设计并成功实现了一种用于虚拟前列腺微创介入手术的训练系统中的触觉
%操作机构，结合计算机中的虚拟场景，该系统可以进行前列腺微创介入手术的演示和培训工作\cite{padilla2009virtual}。
%我国学者马炘及其所属新加坡科技局国立生物医学图像研究所团队成功开发了团队内的第一个介入
%手术模拟系统daVinci\cite{wang1996}\cite{chui1996}、用于介入式心血管手术仿真的ICard系统
%\cite{wang1999}\cite{chui1998}以及用于脑血管介入手术仿真的NeuroCath系统\cite{anderson2001}
%\cite{chui2002}\cite{ma2004}\cite{ma2006}。香港中文大学的Simon, C. H. Yu等人成功研发了
%同样用于脑血管介入手术仿真的系统\cite{cuhkweb}。}

\subsection{国内研究现状}
\label{sec1-3-2}

中国科学院深圳先进技术研究院的马炘等人\cite{Ma2010SIAT}。

国防科技大学的熊岳山等人\cite{Tan2012NUDT}。

近年来，随着我国社会经济的不断发展，国民生活水平也有了长足的提高，人们一方面享受到了较
好的物质条件带来的多方面的益处，一方面也由于缺乏端正的健康生活意识而出现了各种由于膳食
结构不合理、体力消耗水平过低而引起的疾病，其中以冠心病等心脑血管疾病为代表的人体循环系
统疾病的发病率和致死率呈逐年上升趋势，这一趋势已引起了医学界和公共卫生部门的高度重视。
正是这样，国内高校和科研院所近年开展与临床手术应用相关的生物工程项目不断增多。然而，由
于我国在相关方面的科研基础与发达国家存在差距，再加上我们在科研成果转化为实际应用方面的
滞后，目前，国内虚拟手术训练的研究仍较为初级。其中与本课题研究方向有一定关系的有：天津
大学的冯鹰\cite{li2005master}等人于2005年设计并实现了用于腹腔镜手术的虚拟训练系统；该
校的王树新等人\cite{zeng2006master}于2006年研究了面向显微外科手术的虚拟血管缝合仿真系
统。国防科技大学的熊岳山等人对虚拟心脏介入手术的相关方面进行了研究，如：几何模型构建技
术\cite{han2005master}、血流模拟和特效场景\cite{ren2005master}、弹簧-振子模型\cite{wang2006master}、
医疗器械的三维建模\cite{zhu2007master}以及碰撞检测技术\cite{kang2007master}等，最近已有
有成型系统的文献报道\cite{tan2012coronary}。上海交通大学的顾力栩等人开展了虚拟手术系统
中模拟手术场景的渲染和平台的创建工作\cite{zheng2008master}以及血管内血流模拟方面的工作\cite{huang2011virtual}；
该校的谢叻等人则在虚拟手术的碰撞检测\cite{wu2010virtual}和触力反馈\cite{wu2011virtual}
方面进行研究。

\subsection{相关技术现状}

本节叙述内容：
\begin{enumerate}
  \item 医学影像处理
  \item 医学可视化
  \item 组织建模与特性分析
  \item 器官的物理特性建模
  \item 虚拟解剖环境的建立
  \item 手术工具与解剖环境的交互
  \item 手术流程的建模
  \item 系统集成
\end{enumerate}

\section{本文工作}

%本节叙述内容：
%\begin{enumerate}
%  \item 研究工作目的
%  \item 论文内容布局
%  \item 组内相关工作
%\end{enumerate}

本文研究工作的目的是：以真实的心血管微创介入导管术为原型，利用计算机相关学科的知识和
技术，研究并实现一种能够以虚拟现实或增强现实的方式来模拟该原型的手术训练系统。该系统
应当具备友好的图形界面；提供为获得足够真实的感受所需的反馈，包括：视觉方面，足够真实
的，与介入式导管术相关的人体解剖结构，以及在外观和物理特性方面足够真实的手术器械（即
导管）；触觉方面，提供与虚拟环境中的视觉反馈相一致的触觉感受，如：导管在进给过程中，
若其顶端触碰到血管壁，操控者手持的触觉接口则会向其提供一个阻力的感受，使操控者仿佛真
实地感受到自己手中操控的导管的顶端碰到了血管的内壁一样。在这样一个过程中，我们所研发
的系统足以为操控者提供一个足够真实具体的手术环境，从而使学员能够获得与其在真实生物体
上进行手术相近的体验，学到远比教科书讲授内容更为真切的技能；使有经验的医师能够在开展
真实手术之前，演练并验证自己的手术方案，提高手术的成功率。

本文的内容编排的原则是开篇介绍本研究项目的基本情况，以及与本研究项目有关的研究进展；
之后的每章叙述一个导管术训练系统的关键技术环节；最后一章总结我们在研究工作中的成果、
经验，与教训，并展望本项目未来的一些可能的发展动向。全文分为十章：第一章是全文绪论，
概括介绍本项目的研究动机、研究背景、以及本文的主要内容，详细描述与本文所述工作相关的
典型样机和关键技术在国内外研究情况和发展历史；第二章是医学背景介绍，比较详细地记述了
与本文所述工作相关的医学知识，包括介入心脏病学和医学影像技术等内容；第三章是血管模型
的提取，介绍了为从CTA中获得血管系统所对应的像素信息所进行的主要工作以及工作成果，详
细描述本环节工作所用到的关键技术内容；第四章是血管模型的可视化，介绍了在第三章工作基
础上获得血管系统的可视化模型所进行的主要工作以及工作成果，深入描述了本环节工作所用到
的关键技术内容；第五章是心脏模型的提取与可视化，介绍了基于CTA的心脏模型的分割与可视
化工作和工作成果，描述了本环节工作所用到的关键技术内容；第六章是组织的物理特性建模，
具体介绍了器官组织物理特性的分析与建模过程；第七章是手术过程中特殊动态效果的实现，描
述了为实现诸如虚拟造影剂、可视化模型的X光显示等可视效果而做的工作，展示了工作成果；
第八章是手术流程的状态机模型研究，主要介绍将冠状动脉导管术的流程进行计算机建模的一种
方法；第九章是软件系统的整合，记录了一些笔者在本研究项目过程中对软件工程的一些思考；
第十章是总结与展望，客观、全面地总结全文内容，概括本研究项目所取得的工作成果，列出在
此过程中表现出来的一些教训，最后对本研究工作的未来发展做了一些预测。

本文所述工作是“经皮介入冠脉导管术仿真系统的设计与研究”的一部分，工作任务涉及血管系
统和心脏等解剖结构的场景生成和仿真。关于该仿真系统中的手术工具的物理建模与仿真，请参
考组内同事米韶华的博士学位论文《XXX》以及相关的已发表科技文章。

本文所述工作获得了国家自然科学基金（61225017）和北京市优秀博士学位论文指导教师科技项
目(YB20108000103)资助。在此，笔者谨代表其所在的研究团队向国家自然科学基金委员会和北
京市教育委员会表示由衷的感谢！ 